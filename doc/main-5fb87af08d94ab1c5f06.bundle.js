/*! For license information please see main-5fb87af08d94ab1c5f06.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,n,s={783:(t,e,n)=>{var s=n(618),i=Object.create(null),r="undefined"==typeof document,o=Array.prototype.forEach;function a(){}function c(t,e){if(!e){if(!t.href)return;e=t.href.split("?")[0]}if(l(e)&&!1!==t.isLoaded&&e&&e.indexOf(".css")>-1){t.visited=!0;var n=t.cloneNode();n.isLoaded=!1,n.addEventListener("load",(function(){n.isLoaded||(n.isLoaded=!0,t.parentNode.removeChild(t))})),n.addEventListener("error",(function(){n.isLoaded||(n.isLoaded=!0,t.parentNode.removeChild(t))})),n.href="".concat(e,"?").concat(Date.now()),t.nextSibling?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.appendChild(n)}}function u(){var t=document.querySelectorAll("link");o.call(t,(function(t){!0!==t.visited&&c(t)}))}function l(t){return!!/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(t)}t.exports=function(t,e){if(r)return console.log("no window.document found, will not HMR CSS"),a;var n,h,d=function(t){var e=i[t];if(!e){if(document.currentScript)e=document.currentScript.src;else{var n=document.getElementsByTagName("script"),r=n[n.length-1];r&&(e=r.src)}i[t]=e}return function(t){if(!e)return null;var n=e.split(/([^\\/]+)\.js$/),i=n&&n[1];return i&&t?t.split(",").map((function(t){var n=new RegExp("".concat(i,"\\.js$"),"g");return s(e.replace(n,"".concat(t.replace(/{fileName}/g,i),".css")))})):[e.replace(".js",".css")]}}(t);return n=function(){var t=d(e.filename),n=function(t){if(!t)return!1;var e=document.querySelectorAll("link"),n=!1;return o.call(e,(function(e){if(e.href){var i=function(t,e){var n;return t=s(t),e.some((function(s){t.indexOf(e)>-1&&(n=s)})),n}(e.href,t);l(i)&&!0!==e.visited&&i&&(c(e,i),n=!0)}})),n}(t);if(e.locals)return console.log("[HMR] Detected local css modules. Reload all css"),void u();n?console.log("[HMR] css reload %s",t.join(" ")):(console.log("[HMR] Reload all css"),u())},50,h=0,function(){var t=this,e=arguments;clearTimeout(h),h=setTimeout((function(){return n.apply(t,e)}),50)}}},618:t=>{t.exports=function(t){if(t=t.trim(),/^data:/i.test(t))return t;var e=-1!==t.indexOf("//")?t.split("//")[0]+"//":"",n=t.replace(new RegExp(e,"i"),"").split("/"),s=n[0].toLowerCase().replace(/\.$/,"");return n[0]="",e+s+n.reduce((function(t,e){switch(e){case"..":t.pop();break;case".":break;default:t.push(e)}return t}),[]).join("/")}},353:(t,e,n)=>{var s=n(783)(t.id,{locals:!1});t.hot.dispose(s),t.hot.accept(void 0,s)},2:(t,e,n)=>{n(353);var s=n(260),i=n.n(s);const r="JumpLeft";class o extends i().Physics.Arcade.Sprite{constructor(t,e,n,s,i){super(t,e??100,n??64,s||"dude",i??27),t.physics.add.existing(this,!1),this.body.collideWorldBounds=!0,this.body.setOffset(25,7),this.body.setSize(12,55,!1)}die(){this.setTint(16711680),this.play(r)}}class a extends i().Physics.Arcade.Image{constructor(t,e,n,s,r){super(t,e??153,n??64,s||"star",r),this.scaleX=.014771200044305953,this.scaleY=.014771200044305953,t.physics.add.existing(this,!1),this.body.setSize(2e3,1925,!1),this.setBounceY(i().Math.FloatBetween(.4,.8))}collected(){this.disableBody(!0,!0)}resetStar(){this.enableBody(!0,i().Math.Between(0,1280),i().Math.Between(0,600),!0,!0)}}class c extends i().Physics.Arcade.Image{constructor(t,e,n,s,i){super(t,e??4,n??4,s||"platform",i),this.scaleX=.5684960719841474,this.scaleY=.134667199855117,this.setOrigin(0,0),t.physics.add.existing(this,!0),this.body.setOffset(26,28),this.body.setSize(556,61,!1)}}class u extends i().Physics.Arcade.Image{constructor(t,e,n,s,r){super(t,e??380,n??186,s||"bomb",r),this.scaleX=.03288430912274877,this.scaleY=.03288430912274877,t.physics.add.existing(this,!1),this.body.bounce.x=1,this.body.bounce.y=1,this.body.collideWorldBounds=!0,this.body.setOffset(0,533),this.body.setSize(1152,1117,!1),this.setVelocity(i().Math.Between(-200,200),20)}}const l="js-save-score",h="is-freeze",d="userName",f={closeDropdown:"close:dropdown"},p=new class{privateState={};state={currentScore:0};stateListeners=[];customEventsListeners=[];customEventsArray=[];constructor(){Object.defineProperty(this,"state",{get:()=>this.privateState,configurable:!1});for(let t in f)this.customEventsArray.push(new Event(f[t],{bubbles:!0}));this._initEvents()}setState(t,e){for(let e in t)t.hasOwnProperty(e)&&(this.privateState[e]=t[e]);e&&e(),this.stateListeners.forEach((t=>{t.callback&&"function"==typeof t.callback?t.callback(this.state):console.warn("Can not find appropriate callback function in App.ts")})),this.dispatchCustomEvent("app:refresh")}_initEvents(){window.addEventListener("click",(t=>{this._dispatchCustomMouseEvents(t)}))}dispatchCustomEvent(t){const e=new Event(t,{bubbles:!0});window.dispatchEvent(e)}_dispatchCustomMouseEvents(t){this.customEventsListeners.forEach((e=>{let n=!1,s=t.target;for(;s&&"body"!==s.nodeName.toLowerCase();){if(s===e){n=!0;break}s=s.parentNode}n||this.customEventsArray.forEach((t=>{e.dispatchEvent(t)}))}))}};class g extends i().Scene{constructor(){super("Level"),p.setState({isFlashVelocityAvailable:!0,velocityValue:160}),this.documentElement=document.documentElement}editorCreate(){const t=this.input.keyboard.addKey(i().Input.Keyboard.KeyCodes.LEFT),e=this.input.keyboard.addKey(i().Input.Keyboard.KeyCodes.RIGHT),n=this.input.keyboard.addKey(i().Input.Keyboard.KeyCodes.UP),s=this.input.keyboard.addKey(i().Input.Keyboard.KeyCodes.SPACE),r=this.add.image(640,360,"sky");r.scaleX=1.6162429819166788,r.scaleY=1.2070412376520576;const u=new o(this,465,233);this.add.existing(u);const l=this.add.layer(),h=new a(this,38,-38.27272727272724);l.add(h);const d=new a(this,157.5424000886119,-38.27272727272724);l.add(d);const f=new a(this,277.0848001772238,-38.27272727272724);l.add(f);const p=new a(this,396.62720026583577,-38.27272727272724);l.add(p);const g=new a(this,516.1696003544477,-38.27272727272724);l.add(g);const m=new a(this,635.7120004430595,-38.27272727272724);l.add(m);const y=new a(this,755.2544005316714,-38.27272727272724);l.add(y);const v=new a(this,874.7968006202833,-38.27272727272724);l.add(v);const w=new a(this,994.3392007088952,-38.27272727272724);l.add(w);const b=new a(this,1113.8816007975072,-38.27272727272724);l.add(b);const E=new a(this,1233.424000886119,-38.27272727272724);l.add(E);const T=this.add.layer(),I=new c(this,-6,336);T.add(I);const S=new c(this,690,478);T.add(S);const C=new c(this,904,300);T.add(C);const _=new c(this,-8,639);_.scaleX=1.2408567062942588,_.scaleY=.134667199855117,_.body.setOffset(4,28),_.body.setSize(1274,187,!1),T.add(_);const A=this.add.layer();this.physics.add.collider(u,T.list),this.physics.add.collider(l.list,T.list),this.physics.add.overlap(u,l.list,this.collectStar,void 0,this),this.physics.add.collider(A.list,T.list),this.physics.add.collider(u,A.list,this.hitBomb,void 0,this),this.physics.add.collider(A.list,A.list),this.player=u,this.starsLayer=l,this.platformGround=_,this.bombsLayer=A,this.leftKey=t,this.rightKey=e,this.upKey=n,this.spaceBar=s,this.events.emit("scene-awake")}player;starsLayer;platformGround;bombsLayer;leftKey;rightKey;upKey;spaceBar;documentElement=null;state={moveDirection:"right",moveAction:"move"};gameOver=!1;create(){this.editorCreate(),this.spawnBomb()}update(){this.gameOver||this.updatePlayer()}hitBomb(t,e){this.physics.pause(),t.die(),this.gameOver=!0,p.dispatchCustomEvent("game:over")}collectStar(t,e){const n=p.state.currentScore||0;if(e.collected(),p.setState({currentScore:n+10}),this.noStarActive()){for(let t of this.starsLayer.list)t.resetStar();this.spawnBomb()}}spawnBomb(){const t=this.cameras.main.width,e=this.player.x<t/2?i().Math.Between(t/2,t):i().Math.Between(0,t/2),n=new u(this,e,0);this.bombsLayer.add(n)}noStarActive(){for(const t of this.starsLayer.list)if(t.active)return!1;return!0}updatePlayer(){let t=null,e=null,n=null,s=0;const i="right";switch(this.leftKey.isDown?(t="left",e="move",this.player.setVelocityX(-p.state.velocityValue),this.state.moveDirection=t,this.state.moveAction=e):this.rightKey.isDown?(t="right",e="move",this.player.setVelocityX(p.state.velocityValue),this.state.moveDirection=t,this.state.moveAction=e):(e="idle",this.player.setVelocityX(0),this.state.moveAction=e),this.spaceBar.isDown&&p.state.isFlashVelocityAvailable&&(p.setState({isFlashVelocityAvailable:!1,velocityValue:1e3}),n=setInterval((()=>{s+=10/3e3,this.documentElement.style.setProperty("--flash-velocity-cooldown",100*s+"%")}),10),setTimeout((()=>{p.setState({velocityValue:160})}),150),setTimeout((()=>{clearInterval(n),p.setState({isFlashVelocityAvailable:!0})}),3e3)),this.upKey.isDown&&this.player.body.touching.down&&(e="jump",this.player.setVelocityY(-330),this.state.moveAction=e),this.player.body.touching.down||(e="jump",this.state.moveAction=e),this.state.moveAction){case"move":this.state.moveDirection===i?this.player.play("Right",!0):this.player.play("Left",!0);break;case"jump":this.state.moveDirection===i?this.player.play("JumpRight",!0):this.player.play(r,!0);break;default:this.state.moveDirection===i?this.player.play("FaceRight",!0):this.player.play("FaceLeft",!0)}}}class m{_scene;_gameObject;_parent;_children;constructor(t){this._parent=t,t instanceof m?(this._scene=t.scene,this._gameObject=t.gameObject,t.add(this)):t instanceof i().GameObjects.GameObject?(this._scene=t.scene,this._gameObject=t):this._scene=t;const e=this.awake!==m.prototype.awake,n=this.start!==m.prototype.start,s=this.update!==m.prototype.update,r=this.destroy!==m.prototype.destroy;if(e&&this.scene.events.once("scene-awake",this.awake,this),n&&this.scene.events.once(i().Scenes.Events.UPDATE,this.start,this),s&&this.scene.events.on(i().Scenes.Events.UPDATE,this.update,this),n||s||r){const t=()=>{this.scene.events.off(i().Scenes.Events.UPDATE,this.start,this),this.scene.events.off(i().Scenes.Events.UPDATE,this.update,this),r&&this.destroy()};this.gameObject?this.gameObject.on(i().GameObjects.Events.DESTROY,t):this.scene.events.on(i().Scenes.Events.DESTROY,t)}}get scene(){return this._scene}get gameObject(){return this._gameObject}get parent(){return this._parent}get children(){return this._children||(this._children=[]),this._children}add(t){this.children.push(t)}executeChildren(t){if(this._children)for(const e of this._children)e.execute(t)}execute(t){}awake(){}start(){}update(){}destroy(){}}class y extends m{constructor(t){super(t)}get gameObject(){return super.gameObject}awake(){const t=this.gameObject.width;this.scene.load.on(i().Loader.Events.PROGRESS,(e=>{this.gameObject.width=t*e}))}}const v=n.p+"asset-packs/asset-pack-a100b90c4a060385255d.json";class w extends i().Scene{constructor(){super("Preload")}editorCreate(){const t=this.add.image(505.0120544433594,360,"guapen");t.scaleX=.32715486817515643,t.scaleY=.32715486817515643;const e=this.add.rectangle(553.0120849609375,361,256,20);e.setOrigin(0,0),e.isFilled=!0,e.fillColor=14737632,new y(e);const n=this.add.rectangle(553.0120849609375,361,256,20);n.setOrigin(0,0),n.fillColor=14737632,n.isStroked=!0;const s=this.add.text(552.0120849609375,329,"",{});s.text="Loading...",s.setStyle({color:"#e0e0e0",fontFamily:"arial",fontSize:"20px"}),this.events.emit("scene-awake")}preload(){this.editorCreate(),this.load.pack("asset-pack",v)}create(){this.scene.start("Level")}}const b=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&s+1<t.length&&56320==(64512&t.charCodeAt(s+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++s)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},E={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let e=0;e<t.length;e+=3){const i=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(h=64)),s.push(n[u],n[l],n[h],n[d])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(b(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((31&i)<<6|63&r)}else if(i>239&&i<365){const r=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[s++]=String.fromCharCode(55296+(r>>10)),e[s++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let e=0;e<t.length;){const i=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==i||null==r||null==o||null==a)throw new T;const c=i<<2|r>>4;if(s.push(c),64!==o){const t=r<<4&240|o>>2;if(s.push(t),64!==a){const t=o<<6&192|a;s.push(t)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class T extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I=function(t){return function(t){const e=b(t);return E.encodeByteArray(e,!0)}(t).replace(/\./g,"")},S=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&function(t){try{return E.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},C=()=>{var t;return null===(t=S())||void 0===t?void 0:t.config};class _{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function A(){try{return"object"==typeof indexedDB}catch(t){return!1}}function D(){return new Promise(((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class k extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N.prototype.create)}}class N{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],r=i?function(t,e){return t.replace(L,((t,n)=>{const s=e[n];return null!=s?String(s):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${r} (${s}).`;return new k(s,o,n)}}const L=/\{\$([^}]+)}/g;function x(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const n=t[i],r=e[i];if(O(n)&&O(r)){if(!x(n,r))return!1}else if(n!==r)return!1}for(const t of s)if(!n.includes(t))return!1;return!0}function O(t){return null!==t&&"object"==typeof t}const R=1e3,M=2,P=144e5,F=.5;function V(t,e=R,n=M){const s=e*Math.pow(n,t),i=Math.round(F*s*(Math.random()-.5)*2);return Math.min(P,s+i)}function B(t){return t&&t._delegate?t._delegate:t}class U{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const j="[DEFAULT]";class q{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new _;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),s=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(s)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:j})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=j){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=j){return this.instances.has(t)}getOptions(t=j){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(s);return s}onInit(t,e){var n;const s=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(s))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&t(r,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===j?void 0:s),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var s;return n||null}normalizeInstanceIdentifier(t=j){return this.component?this.component.multipleInstances?t:j:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ${constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new q(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const z=[];var K,H;(H=K||(K={}))[H.DEBUG=0]="DEBUG",H[H.VERBOSE=1]="VERBOSE",H[H.INFO=2]="INFO",H[H.WARN=3]="WARN",H[H.ERROR=4]="ERROR",H[H.SILENT=5]="SILENT";const G={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},Q=K.INFO,W={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},X=(t,e,...n)=>{if(e<t.logLevel)return;const s=(new Date).toISOString(),i=W[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${s}]  ${t.name}:`,...n)};class Y{constructor(t){this.name=t,this._logLevel=Q,this._logHandler=X,this._userLogHandler=null,z.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in K))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?G[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...t),this._logHandler(this,K.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...t),this._logHandler(this,K.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,K.INFO,...t),this._logHandler(this,K.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,K.WARN,...t),this._logHandler(this,K.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...t),this._logHandler(this,K.ERROR,...t)}}const J=(t,e)=>e.some((e=>t instanceof e));let Z,tt;const et=new WeakMap,nt=new WeakMap,st=new WeakMap,it=new WeakMap,rt=new WeakMap;let ot={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return nt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||st.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ct(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function at(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(tt||(tt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ut(this),t),ct(et.get(this))}:function(...t){return ct(e.apply(ut(this),t))}:function(t,...n){const s=e.call(ut(this),t,...n);return st.set(s,t.sort?t.sort():[t]),ct(s)}:(t instanceof IDBTransaction&&function(t){if(nt.has(t))return;const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",r),t.removeEventListener("abort",r)},i=()=>{e(),s()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",r),t.addEventListener("abort",r)}));nt.set(t,e)}(t),J(t,Z||(Z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,ot):t);var e}function ct(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",r)},i=()=>{e(ct(t.result)),s()},r=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&et.set(e,t)})).catch((()=>{})),rt.set(e,t),e}(t);if(it.has(t))return it.get(t);const e=at(t);return e!==t&&(it.set(t,e),rt.set(e,t)),e}const ut=t=>rt.get(t),lt=["get","getKey","getAll","getAllKeys","count"],ht=["put","add","delete","clear"],dt=new Map;function ft(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(dt.get(e))return dt.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=ht.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!i&&!lt.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,i?"readwrite":"readonly");let o=r.store;return s&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&r.done]))[0]};return dt.set(e,r),r}var pt;pt=ot,ot={...pt,get:(t,e,n)=>ft(t,e)||pt.get(t,e,n),has:(t,e)=>!!ft(t,e)||pt.has(t,e)};class gt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const mt="@firebase/app",yt="0.9.13",vt=new Y("@firebase/app"),wt="[DEFAULT]",bt={[mt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Et=new Map,Tt=new Map;function It(t,e){try{t.container.addComponent(e)}catch(n){vt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function St(t){const e=t.name;if(Tt.has(e))return vt.debug(`There were multiple attempts to register component ${e}.`),!1;Tt.set(e,t);for(const e of Et.values())It(e,t);return!0}function Ct(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const _t=new N("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class At{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new U("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw _t.create("app-deleted",{appName:this._name})}}function Dt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const s=Object.assign({name:wt,automaticDataCollectionEnabled:!1},e),i=s.name;if("string"!=typeof i||!i)throw _t.create("bad-app-name",{appName:String(i)});if(n||(n=C()),!n)throw _t.create("no-options");const r=Et.get(i);if(r){if(x(n,r.options)&&x(s,r.config))return r;throw _t.create("duplicate-app",{appName:i})}const o=new $(i);for(const t of Tt.values())o.addComponent(t);const a=new At(n,s,o);return Et.set(i,a),a}function kt(t=wt){const e=Et.get(t);if(!e&&t===wt&&C())return Dt();if(!e)throw _t.create("no-app",{appName:t});return e}function Nt(t,e,n){var s;let i=null!==(s=bt[t])&&void 0!==s?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const t=[`Unable to register library "${i}" with version "${e}":`];return r&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void vt.warn(t.join(" "))}St(new U(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const Lt="firebase-heartbeat-database",xt=1,Ot="firebase-heartbeat-store";let Rt=null;function Mt(){return Rt||(Rt=function(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),a=ct(o);return s&&o.addEventListener("upgradeneeded",(t=>{s(ct(o.result),t.oldVersion,t.newVersion,ct(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{r&&t.addEventListener("close",(()=>r())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(Lt,xt,{upgrade:(t,e)=>{0===e&&t.createObjectStore(Ot)}}).catch((t=>{throw _t.create("idb-open",{originalErrorMessage:t.message})}))),Rt}async function Pt(t,e){try{const n=(await Mt()).transaction(Ot,"readwrite"),s=n.objectStore(Ot);await s.put(e,Ft(t)),await n.done}catch(t){if(t instanceof k)vt.warn(t.message);else{const e=_t.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});vt.warn(e.message)}}}function Ft(t){return`${t.name}!${t.options.appId}`}class Vt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Ut(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=Bt();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=Bt(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let s=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),jt(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),jt(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}(this._heartbeatsCache.heartbeats),s=I(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Bt(){return(new Date).toISOString().substring(0,10)}class Ut{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!A()&&D().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await Mt();return await e.transaction(Ot).objectStore(Ot).get(Ft(t))}catch(t){if(t instanceof k)vt.warn(t.message);else{const e=_t.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});vt.warn(e.message)}}}(this.app);return t||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Pt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Pt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function jt(t){return I(JSON.stringify({version:2,heartbeats:t})).length}St(new U("platform-logger",(t=>new gt(t)),"PRIVATE")),St(new U("heartbeat",(t=>new Vt(t)),"PRIVATE")),Nt(mt,yt,""),Nt(mt,yt,"esm2017"),Nt("fire-js","");var qt,$t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},zt={},Kt=Kt||{},Ht=$t||self;function Gt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Qt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Wt="closure_uid_"+(1e9*Math.random()>>>0),Xt=0;function Yt(t,e,n){return t.call.apply(t.bind,arguments)}function Jt(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,s),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Zt(t,e,n){return(Zt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Yt:Jt).apply(null,arguments)}function te(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ee(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,s){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return e.prototype[n].apply(t,i)}}function ne(){this.s=this.s,this.o=this.o}ne.prototype.s=!1,ne.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Wt)&&t[Wt]||(t[Wt]=++Xt))},ne.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const se=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function ie(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function re(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Gt(n)){const e=t.length||0,s=n.length||0;t.length=e+s;for(let i=0;i<s;i++)t[e+i]=n[i]}else t.push(n)}}function oe(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var ae=function(){if(!Ht.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Ht.addEventListener("test",(()=>{}),e),Ht.removeEventListener("test",(()=>{}),e)}catch(t){}return t}();function ce(t){return/^[\s\xa0]*$/.test(t)}function ue(){var t=Ht.navigator;return t&&(t=t.userAgent)?t:""}function le(t){return-1!=ue().indexOf(t)}function he(t){return he[" "](t),t}he[" "]=function(){};var de,fe,pe,ge=le("Opera"),me=le("Trident")||le("MSIE"),ye=le("Edge"),ve=ye||me,we=le("Gecko")&&!(-1!=ue().toLowerCase().indexOf("webkit")&&!le("Edge"))&&!(le("Trident")||le("MSIE"))&&!le("Edge"),be=-1!=ue().toLowerCase().indexOf("webkit")&&!le("Edge");function Ee(){var t=Ht.document;return t?t.documentMode:void 0}t:{var Te="",Ie=(fe=ue(),we?/rv:([^\);]+)(\)|;)/.exec(fe):ye?/Edge\/([\d\.]+)/.exec(fe):me?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(fe):be?/WebKit\/(\S+)/.exec(fe):ge?/(?:Version)[ \/]?(\S+)/.exec(fe):void 0);if(Ie&&(Te=Ie?Ie[1]:""),me){var Se=Ee();if(null!=Se&&Se>parseFloat(Te)){de=String(Se);break t}}de=Te}Ht.document&&me?pe=Ee()||parseInt(de,10)||void 0:pe=void 0;var Ce=pe;function _e(t,e){if(oe.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(we){t:{try{he(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ae[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&_e.$.h.call(this)}}ee(_e,oe);var Ae={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),ke=0;function Ne(t,e,n,s,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.la=i,this.key=++ke,this.fa=this.ia=!1}function Le(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function xe(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function Oe(t){const e={};for(const n in t)e[n]=t[n];return e}const Re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Me(t,e){let n,s;for(let e=1;e<arguments.length;e++){for(n in s=arguments[e],s)t[n]=s[n];for(let e=0;e<Re.length;e++)n=Re[e],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function Pe(t){this.src=t,this.g={},this.h=0}function Fe(t,e){var n=e.type;if(n in t.g){var s,i=t.g[n],r=se(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(Le(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ve(t,e,n,s){for(var i=0;i<t.length;++i){var r=t[i];if(!r.fa&&r.listener==e&&r.capture==!!n&&r.la==s)return i}return-1}Pe.prototype.add=function(t,e,n,s,i){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=Ve(t,e,s,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Ne(e,this.src,r,!!s,i)).ia=n,t.push(e)),e};var Be="closure_lm_"+(1e6*Math.random()|0),Ue={};function je(t,e,n,s,i){if(s&&s.once)return $e(t,e,n,s,i);if(Array.isArray(e)){for(var r=0;r<e.length;r++)je(t,e[r],n,s,i);return null}return n=Xe(n),t&&t[De]?t.O(e,n,Qt(s)?!!s.capture:!!s,i):qe(t,e,n,!1,s,i)}function qe(t,e,n,s,i,r){if(!e)throw Error("Invalid event type");var o=Qt(i)?!!i.capture:!!i,a=Qe(t);if(a||(t[Be]=a=new Pe(t)),(n=a.add(e,n,s,o,r)).proxy)return n;if(s=function(){const t=Ge;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)ae||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),s,i);else if(t.attachEvent)t.attachEvent(He(e.toString()),s);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(s)}return n}function $e(t,e,n,s,i){if(Array.isArray(e)){for(var r=0;r<e.length;r++)$e(t,e[r],n,s,i);return null}return n=Xe(n),t&&t[De]?t.P(e,n,Qt(s)?!!s.capture:!!s,i):qe(t,e,n,!0,s,i)}function ze(t,e,n,s,i){if(Array.isArray(e))for(var r=0;r<e.length;r++)ze(t,e[r],n,s,i);else s=Qt(s)?!!s.capture:!!s,n=Xe(n),t&&t[De]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Ve(r=t.g[e],n,s,i))&&(Le(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--))):t&&(t=Qe(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ve(e,n,s,i)),(n=-1<t?e[t]:null)&&Ke(n))}function Ke(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[De])Fe(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(He(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=Qe(e))?(Fe(n,t),0==n.h&&(n.src=null,e[Be]=null)):Le(t)}}}function He(t){return t in Ue?Ue[t]:Ue[t]="on"+t}function Ge(t,e){if(t.fa)t=!0;else{e=new _e(e,this);var n=t.listener,s=t.la||t.src;t.ia&&Ke(t),t=n.call(s,e)}return t}function Qe(t){return(t=t[Be])instanceof Pe?t:null}var We="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xe(t){return"function"==typeof t?t:(t[We]||(t[We]=function(e){return t.handleEvent(e)}),t[We])}function Ye(){ne.call(this),this.i=new Pe(this),this.S=this,this.J=null}function Je(t,e){var n,s=t.J;if(s)for(n=[];s;s=s.J)n.push(s);if(t=t.S,s=e.type||e,"string"==typeof e)e=new oe(e,t);else if(e instanceof oe)e.target=e.target||t;else{var i=e;Me(e=new oe(s,t),i)}if(i=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];i=Ze(o,s,!0,e)&&i}if(i=Ze(o=e.g=t,s,!0,e)&&i,i=Ze(o,s,!1,e)&&i,n)for(r=0;r<n.length;r++)i=Ze(o=e.g=n[r],s,!1,e)&&i}function Ze(t,e,n,s){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Fe(t.i,o),i=!1!==a.call(c,s)&&i}}return i&&!s.defaultPrevented}ee(Ye,ne),Ye.prototype[De]=!0,Ye.prototype.removeEventListener=function(t,e,n,s){ze(this,t,e,n,s)},Ye.prototype.N=function(){if(Ye.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],s=0;s<n.length;s++)Le(n[s]);delete e.g[t],e.h--}}this.J=null},Ye.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)},Ye.prototype.P=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};var tn=Ht.JSON.stringify;function en(){var t=un;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var nn=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new sn),(t=>t.reset()));class sn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function rn(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function on(t){Ht.setTimeout((()=>{throw t}),0)}let an,cn=!1,un=new class{constructor(){this.h=this.g=null}add(t,e){const n=nn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},ln=()=>{const t=Ht.Promise.resolve(void 0);an=()=>{t.then(hn)}};var hn=()=>{for(var t;t=en();){try{t.h.call(t.g)}catch(t){on(t)}var e=nn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}cn=!1};function dn(t,e){Ye.call(this),this.h=t||1,this.g=e||Ht,this.j=Zt(this.qb,this),this.l=Date.now()}function fn(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function pn(t,e,n){if("function"==typeof t)n&&(t=Zt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Zt(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ht.setTimeout(t,e||0)}function gn(t){t.g=pn((()=>{t.g=null,t.i&&(t.i=!1,gn(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}ee(dn,Ye),(qt=dn.prototype).ga=!1,qt.T=null,qt.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Je(this,"tick"),this.ga&&(fn(this),this.start()))}},qt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},qt.N=function(){dn.$.N.call(this),fn(this),delete this.g};class mn extends ne{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:gn(this)}N(){super.N(),this.g&&(Ht.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yn(t){ne.call(this),this.h=t,this.g={}}ee(yn,ne);var vn=[];function wn(t,e,n,s){Array.isArray(n)||(n&&(vn[0]=n.toString()),n=vn);for(var i=0;i<n.length;i++){var r=je(e,n[i],s||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function bn(t){xe(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ke(t)}),t),t.g={}}function En(){this.g=!0}function Tn(t,e,n,s){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var i=s[1];if(Array.isArray(i)&&!(1>i.length)){var r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return tn(n)}catch(t){return e}}(t,n)+(s?" "+s:"")}))}yn.prototype.N=function(){yn.$.N.call(this),bn(this)},yn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},En.prototype.Ea=function(){this.g=!1},En.prototype.info=function(){};var In={},Sn=null;function Cn(){return Sn=Sn||new Ye}function _n(t){oe.call(this,In.Ta,t)}function An(t){const e=Cn();Je(e,new _n(e))}function Dn(t,e){oe.call(this,In.STAT_EVENT,t),this.stat=e}function kn(t){const e=Cn();Je(e,new Dn(e,t))}function Nn(t,e){oe.call(this,In.Ua,t),this.size=e}function Ln(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ht.setTimeout((function(){t()}),e)}In.Ta="serverreachability",ee(_n,oe),In.STAT_EVENT="statevent",ee(Dn,oe),In.Ua="timingevent",ee(Nn,oe);var xn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},On={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Rn(){}function Mn(t){return t.h||(t.h=t.i())}function Pn(){}Rn.prototype.h=null;var Fn,Vn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Bn(){oe.call(this,"d")}function Un(){oe.call(this,"c")}function jn(){}function qn(t,e,n,s){this.l=t,this.j=e,this.m=n,this.W=s||1,this.U=new yn(this),this.P=zn,t=ve?125:void 0,this.V=new dn(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new $n}function $n(){this.i=null,this.g="",this.h=!1}ee(Bn,oe),ee(Un,oe),ee(jn,Rn),jn.prototype.g=function(){return new XMLHttpRequest},jn.prototype.i=function(){return{}},Fn=new jn;var zn=45e3,Kn={},Hn={};function Gn(t,e,n){t.L=1,t.v=ds(as(e)),t.s=n,t.S=!0,Qn(t,null)}function Qn(t,e){t.G=Date.now(),Jn(t),t.A=as(t.v);var n=t.A,s=t.W;Array.isArray(s)||(s=[String(s)]),Cs(n.i,"t",s),t.C=0,n=t.l.J,t.h=new $n,t.g=Si(t.l,n?e:null,!t.s),0<t.O&&(t.M=new mn(Zt(t.Pa,t,t.g),t.O)),wn(t.U,t.g,"readystatechange",t.nb),e=t.I?Oe(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),An(),function(t,e,n,s,i,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+s+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.W,t.s)}function Wn(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.l.Ha}function Xn(t,e,n){let s,i=!0;for(;!t.J&&t.C<n.length;){if(s=Yn(t,n),s==Hn){4==e&&(t.o=4,kn(14),i=!1),Tn(t.j,t.m,null,"[Incomplete Response]");break}if(s==Kn){t.o=4,kn(15),Tn(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Tn(t.j,t.m,s,null),ss(t,s)}Wn(t)&&s!=Hn&&s!=Kn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,kn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),mi(e),e.M=!0,kn(11))):(Tn(t.j,t.m,n,"[Invalid Chunked Response]"),ns(t),es(t))}function Yn(t,e){var n=t.C,s=e.indexOf("\n",n);return-1==s?Hn:(n=Number(e.substring(n,s)),isNaN(n)?Kn:(s+=1)+n>e.length?Hn:(e=e.slice(s,s+n),t.C=s+n,e))}function Jn(t){t.Y=Date.now()+t.P,Zn(t,t.P)}function Zn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ln(Zt(t.lb,t),e)}function ts(t){t.B&&(Ht.clearTimeout(t.B),t.B=null)}function es(t){0==t.l.H||t.J||wi(t.l,t)}function ns(t){ts(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,fn(t.V),bn(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function ss(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Ls(n.i,t)))if(!t.K&&Ls(n.i,t)&&3==n.H){try{var s=n.Ja.g.parse(e)}catch(t){s=null}if(Array.isArray(s)&&3==s.length){var i=s;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;vi(n),ci(n)}gi(n),kn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Ln(Zt(n.ib,n),6e3));if(1>=Ns(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else Ei(n,11)}else if((t.K||n.g==t)&&vi(n),!ce(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const e=u[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const i=u[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(s=1.5*l,n.L=s,n.l.info("backChannelRequestTimeoutMs_="+s)),s=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=s.i;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(xs(r,r.h),r.h=null))}if(s.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(s.Da=t,hs(s.I,s.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((s=n).wa=Ii(s,s.J?s.pa:null,s.Y),o.K){Os(s.i,o);var a=o,c=s.L;c&&a.setTimeout(c),a.B&&(ts(a),Jn(a)),s.g=o}else pi(s);0<n.j.length&&li(n)}else"stop"!=u[0]&&"close"!=u[0]||Ei(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Ei(n,7):ai(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}An()}catch(t){}}function is(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Gt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Gt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const s in t)e[n++]=s;return e}}}(t),s=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Gt(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}for(s in e=[],n=0,t)e[n++]=t[s];return e}(t),i=s.length,r=0;r<i;r++)e.call(void 0,s[r],n&&n[r],t)}(qt=qn.prototype).setTimeout=function(t){this.P=t},qt.nb=function(t){t=t.target;const e=this.M;e&&3==ei(t)?e.l():this.Pa(t)},qt.Pa=function(t){try{if(t==this.g)t:{const l=ei(this.g);var e=this.g.Ia();if(this.g.da(),!(3>l)&&(3!=l||ve||this.g&&(this.h.h||this.g.ja()||ni(this.g)))){this.J||4!=l||7==e||An(),ts(this);var n=this.g.da();this.ca=n;e:if(Wn(this)){var s=ni(this.g);t="";var i=s.length,r=4==ei(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ns(this),es(this);var o="";break e}this.h.i=new Ht.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:r&&e==i-1});s.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,s,i,r,o){t.info((function(){return"XMLHTTP RESP ("+s+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ce(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.o=3,kn(12),ns(this),es(this);break t}Tn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ss(this,n)}this.S?(Xn(this,l,o),ve&&this.i&&3==l&&(wn(this.U,this.V,"tick",this.mb),this.V.start())):(Tn(this.j,this.m,o,null),ss(this,o)),4==l&&ns(this),this.i&&!this.J&&(4==l?wi(this.l,this):(this.i=!1,Jn(this)))}else(function(t){const e={};t=(t.g&&2<=ei(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let s=0;s<t.length;s++){if(ce(t[s]))continue;var n=rn(t[s]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const r=e[i]||[];e[i]=r,r.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,kn(12)):(this.o=0,kn(13)),ns(this),es(this)}}}catch(t){}},qt.mb=function(){if(this.g){var t=ei(this.g),e=this.g.ja();this.C<e.length&&(ts(this),Xn(this,t,e),this.i&&4!=t&&Jn(this))}},qt.cancel=function(){this.J=!0,ns(this)},qt.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.L&&(An(),kn(17)),ns(this),this.o=2,es(this)):Zn(this,this.Y-t)};var rs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function os(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof os){this.h=t.h,cs(this,t.j),this.s=t.s,this.g=t.g,us(this,t.m),this.l=t.l;var e=t.i,n=new Es;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),ls(this,n),this.o=t.o}else t&&(e=String(t).match(rs))?(this.h=!1,cs(this,e[1]||"",!0),this.s=fs(e[2]||""),this.g=fs(e[3]||"",!0),us(this,e[4]),this.l=fs(e[5]||"",!0),ls(this,e[6]||"",!0),this.o=fs(e[7]||"")):(this.h=!1,this.i=new Es(null,this.h))}function as(t){return new os(t)}function cs(t,e,n){t.j=n?fs(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function us(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ls(t,e,n){e instanceof Es?(t.i=e,function(t,e){e&&!t.j&&(Ts(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Is(this,e),Cs(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=ps(e,ws)),t.i=new Es(e,t.h))}function hs(t,e,n){t.i.set(e,n)}function ds(t){return hs(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function fs(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ps(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,gs),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function gs(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}os.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ps(e,ms,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ps(e,ms,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(ps(n,"/"==n.charAt(0)?vs:ys,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ps(n,bs)),t.join("")};var ms=/[#\/\?@]/g,ys=/[#\?:]/g,vs=/[#\?]/g,ws=/[#\?@]/g,bs=/#/g;function Es(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ts(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),i=null;if(0<=s){var r=t[n].substring(0,s);i=t[n].substring(s+1)}else r=t[n];e(r,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Is(t,e){Ts(t),e=_s(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ss(t,e){return Ts(t),e=_s(t,e),t.g.has(e)}function Cs(t,e,n){Is(t,e),0<n.length&&(t.i=null,t.g.set(_s(t,e),ie(n)),t.h+=n.length)}function _s(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function As(t){this.l=t||Ds,t=Ht.PerformanceNavigationTiming?0<(t=Ht.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ht.g&&Ht.g.Ka&&Ht.g.Ka()&&Ht.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(qt=Es.prototype).add=function(t,e){Ts(this),this.i=null,t=_s(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},qt.forEach=function(t,e){Ts(this),this.g.forEach((function(n,s){n.forEach((function(n){t.call(e,n,s,this)}),this)}),this)},qt.ta=function(){Ts(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let s=0;s<e.length;s++){const i=t[s];for(let t=0;t<i.length;t++)n.push(e[s])}return n},qt.Z=function(t){Ts(this);let e=[];if("string"==typeof t)Ss(this,t)&&(e=e.concat(this.g.get(_s(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},qt.set=function(t,e){return Ts(this),this.i=null,Ss(this,t=_s(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},qt.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},qt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var s=e[n];const r=encodeURIComponent(String(s)),o=this.Z(s);for(s=0;s<o.length;s++){var i=r;""!==o[s]&&(i+="="+encodeURIComponent(String(o[s]))),t.push(i)}}return this.i=t.join("&")};var Ds=10;function ks(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ns(t){return t.h?1:t.g?t.g.size:0}function Ls(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function xs(t,e){t.g?t.g.add(e):t.h=e}function Os(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Rs(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return ie(t.i)}As.prototype.cancel=function(){if(this.i=Rs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Ms=class{stringify(t){return Ht.JSON.stringify(t,void 0)}parse(t){return Ht.JSON.parse(t,void 0)}};function Ps(){this.g=new Ms}function Fs(t,e,n){const s=n||"";try{is(t,(function(t,n){let i=t;Qt(t)&&(i=tn(t)),e.push(s+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}function Vs(t,e,n,s,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(s)}catch(t){}}function Bs(t){this.l=t.fc||null,this.j=t.ob||!1}function Us(t,e){Ye.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=js,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ee(Bs,Rn),Bs.prototype.g=function(){return new Us(this.l,this.j)},Bs.prototype.i=function(t){return function(){return t}}({}),ee(Us,Ye);var js=0;function qs(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function $s(t){t.readyState=4,t.l=null,t.j=null,t.A=null,zs(t)}function zs(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(qt=Us.prototype).open=function(t,e){if(this.readyState!=js)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,zs(this)},qt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Ht).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},qt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$s(this)),this.readyState=js},qt.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,zs(this)),this.g&&(this.readyState=3,zs(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Ht.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qs(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},qt.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?$s(this):zs(this),3==this.readyState&&qs(this)}},qt.Za=function(t){this.g&&(this.response=this.responseText=t,$s(this))},qt.Ya=function(t){this.g&&(this.response=t,$s(this))},qt.ka=function(){this.g&&$s(this)},qt.setRequestHeader=function(t,e){this.v.append(t,e)},qt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},qt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Us.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Ks=Ht.JSON.parse;function Hs(t){Ye.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Gs,this.L=this.M=!1}ee(Hs,Ye);var Gs="",Qs=/^https?$/i,Ws=["POST","PUT"];function Xs(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ys(t),Zs(t)}function Ys(t){t.F||(t.F=!0,Je(t,"complete"),Je(t,"error"))}function Js(t){if(t.h&&void 0!==Kt&&(!t.C[1]||4!=ei(t)||2!=t.da()))if(t.v&&4==ei(t))pn(t.La,0,t);else if(Je(t,"readystatechange"),4==ei(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var s;if(s=0===o){var i=String(t.I).match(rs)[1]||null;!i&&Ht.self&&Ht.self.location&&(i=Ht.self.location.protocol.slice(0,-1)),s=!Qs.test(i?i.toLowerCase():"")}n=s}if(n)Je(t,"complete"),Je(t,"success");else{t.m=6;try{var r=2<ei(t)?t.g.statusText:""}catch(t){r=""}t.j=r+" ["+t.da()+"]",Ys(t)}}finally{Zs(t)}}}function Zs(t,e){if(t.g){ti(t);const n=t.g,s=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Je(t,"ready");try{n.onreadystatechange=s}catch(t){}}}function ti(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Ht.clearTimeout(t.A),t.A=null)}function ei(t){return t.g?t.g.readyState:0}function ni(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Gs:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function si(t){let e="";return xe(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function ii(t,e,n){t:{for(s in n){var s=!1;break t}s=!0}s||(n=si(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):hs(t,e,n))}function ri(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function oi(t){this.Ga=0,this.j=[],this.l=new En,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ri("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ri("baseRetryDelayMs",5e3,t),this.hb=ri("retryDelaySeedMs",1e4,t),this.eb=ri("forwardChannelMaxRetries",2,t),this.xa=ri("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new As(t&&t.concurrentRequestLimit),this.Ja=new Ps,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function ai(t){if(ui(t),3==t.H){var e=t.W++,n=as(t.I);if(hs(n,"SID",t.K),hs(n,"RID",e),hs(n,"TYPE","terminate"),di(t,n),(e=new qn(t,t.l,e)).L=2,e.v=ds(as(n)),n=!1,Ht.navigator&&Ht.navigator.sendBeacon)try{n=Ht.navigator.sendBeacon(e.v.toString(),"")}catch(t){}!n&&Ht.Image&&((new Image).src=e.v,n=!0),n||(e.g=Si(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Jn(e)}Ti(t)}function ci(t){t.g&&(mi(t),t.g.cancel(),t.g=null)}function ui(t){ci(t),t.u&&(Ht.clearTimeout(t.u),t.u=null),vi(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ht.clearTimeout(t.m),t.m=null)}function li(t){if(!ks(t.i)&&!t.m){t.m=!0;var e=t.Na;an||ln(),cn||(an(),cn=!0),un.add(e,t),t.C=0}}function hi(t,e){var n;n=e?e.m:t.W++;const s=as(t.I);hs(s,"SID",t.K),hs(s,"RID",n),hs(s,"AID",t.V),di(t,s),t.o&&t.s&&ii(s,t.o,t.s),n=new qn(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=fi(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),xs(t.i,n),Gn(n,s,e)}function di(t,e){t.na&&xe(t.na,(function(t,n){hs(e,n,t)})),t.h&&is({},(function(t,n){hs(e,n,t)}))}function fi(t,e,n){n=Math.min(t.j.length,n);var s=t.h?Zt(t.h.Va,t.h,t):null;t:{var i=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let r=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=e,0>n)e=Math.max(0,i[o].g-100),r=!1;else try{Fs(a,t,"req"+n+"_")}catch(t){s&&s(a)}}if(r){s=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,s}function pi(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;an||ln(),cn||(an(),cn=!0),un.add(e,t),t.A=0}}function gi(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Ln(Zt(t.Ma,t),bi(t,t.A)),t.A++,0))}function mi(t){null!=t.B&&(Ht.clearTimeout(t.B),t.B=null)}function yi(t){t.g=new qn(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=as(t.wa);hs(e,"RID","rpc"),hs(e,"SID",t.K),hs(e,"AID",t.V),hs(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&hs(e,"TO",t.qa),hs(e,"TYPE","xmlhttp"),di(t,e),t.o&&t.s&&ii(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=ds(as(e)),n.s=null,n.S=!0,Qn(n,t)}function vi(t){null!=t.v&&(Ht.clearTimeout(t.v),t.v=null)}function wi(t,e){var n=null;if(t.g==e){vi(t),mi(t),t.g=null;var s=2}else{if(!Ls(t.i,e))return;n=e.F,Os(t.i,e),s=1}if(0!=t.H)if(e.i)if(1==s){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;Je(s=Cn(),new Nn(s,n)),li(t)}else pi(t);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==s&&function(t,e){return!(Ns(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Ln(Zt(t.Na,t,e),bi(t,t.C)),t.C++,0)))}(t,e)||2==s&&gi(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ei(t,5);break;case 4:Ei(t,10);break;case 3:Ei(t,6);break;default:Ei(t,2)}}function bi(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ei(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var s=Zt(t.pb,t);n||(n=new os("//www.google.com/images/cleardot.gif"),Ht.location&&"http"==Ht.location.protocol||cs(n,"https"),ds(n)),function(t,e){const n=new En;if(Ht.Image){const s=new Image;s.onload=te(Vs,n,s,"TestLoadImage: loaded",!0,e),s.onerror=te(Vs,n,s,"TestLoadImage: error",!1,e),s.onabort=te(Vs,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=te(Vs,n,s,"TestLoadImage: timeout",!1,e),Ht.setTimeout((function(){s.ontimeout&&s.ontimeout()}),1e4),s.src=t}else e(!1)}(n.toString(),s)}else kn(2);t.H=0,t.h&&t.h.za(e),Ti(t),ui(t)}function Ti(t){if(t.H=0,t.ma=[],t.h){const e=Rs(t.i);0==e.length&&0==t.j.length||(re(t.ma,e),re(t.ma,t.j),t.i.i.length=0,ie(t.j),t.j.length=0),t.h.ya()}}function Ii(t,e,n){var s=n instanceof os?as(n):new os(n);if(""!=s.g)e&&(s.g=e+"."+s.g),us(s,s.m);else{var i=Ht.location;s=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var r=new os(null);s&&cs(r,s),e&&(r.g=e),i&&us(r,i),n&&(r.l=n),s=r}return n=t.F,e=t.Da,n&&e&&hs(s,n,e),hs(s,"VER",t.ra),di(t,s),s}function Si(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ha&&!t.va?new Hs(new Bs({ob:!0})):new Hs(t.va)).Oa(t.J),e}function Ci(){}function _i(){if(me&&!(10<=Number(Ce)))throw Error("Environmental error: no available transport.")}function Ai(t,e){Ye.call(this),this.g=new oi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ce(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ce(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Ni(this)}function Di(t){Bn.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ki(){Un.call(this),this.status=1}function Ni(t){this.g=t}function Li(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function xi(t,e,n){n||(n=0);var s=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)s[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)s[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var r=t.g[3],o=e+(r^n&(i^r))+s[0]+3614090360&4294967295;o=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=(n=(i=(r=(e=n+(o<<7&4294967295|o>>>25))+((o=r+(i^e&(n^i))+s[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^r&(e^n))+s[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(r^e))+s[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(i^r))+s[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=r+(i^e&(n^i))+s[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^r&(e^n))+s[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(r^e))+s[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(i^r))+s[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=r+(i^e&(n^i))+s[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^r&(e^n))+s[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(r^e))+s[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^n&(i^r))+s[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=r+(i^e&(n^i))+s[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^r&(e^n))+s[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(r^e))+s[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^r&(n^i))+s[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^i&(e^n))+s[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(r^e))+s[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(i^r))+s[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^r&(n^i))+s[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^i&(e^n))+s[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(r^e))+s[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(i^r))+s[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^r&(n^i))+s[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^i&(e^n))+s[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(r^e))+s[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(i^r))+s[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^r&(n^i))+s[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=r+(n^i&(e^n))+s[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(r^e))+s[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(r^e&(i^r))+s[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^r)+s[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^i)+s[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(r^e^n)+s[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^r^e)+s[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^r)+s[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^i)+s[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(r^e^n)+s[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^r^e)+s[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^r)+s[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^i)+s[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(r^e^n)+s[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^r^e)+s[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^r)+s[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=r+(e^n^i)+s[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(r^e^n)+s[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^r^e)+s[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~r))+s[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~i))+s[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(r|~n))+s[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(i|~e))+s[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~r))+s[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~i))+s[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(r|~n))+s[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(i|~e))+s[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~r))+s[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~i))+s[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(r|~n))+s[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(r^(i|~e))+s[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((r=(e=n+((o=e+(i^(n|~r))+s[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=r+(n^(e|~i))+s[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=r+((o=i+(e^(r|~n))+s[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+s[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+r&4294967295}function Oi(t,e){this.h=e;for(var n=[],s=!0,i=t.length-1;0<=i;i--){var r=0|t[i];s&&r==e||(n[i]=r,s=!1)}this.g=n}(qt=Hs.prototype).Oa=function(t){this.M=t},qt.ha=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Fn.g(),this.C=this.u?Mn(this.u):Mn(Fn),this.g.onreadystatechange=Zt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Xs(this,t)}if(t=n||"",n=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var i in s)n.set(i,s[i]);else{if("function"!=typeof s.keys||"function"!=typeof s.get)throw Error("Unknown input type for opt_headers: "+String(s));for(const t of s.keys())n.set(t,s.get(t))}s=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=Ht.FormData&&t instanceof Ht.FormData,!(0<=se(Ws,e))||s||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{ti(this),0<this.B&&((this.L=function(t){return me&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Zt(this.ua,this)):this.A=pn(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Xs(this,t)}},qt.ua=function(){void 0!==Kt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Je(this,"timeout"),this.abort(8))},qt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Je(this,"complete"),Je(this,"abort"),Zs(this))},qt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Zs(this,!0)),Hs.$.N.call(this)},qt.La=function(){this.s||(this.G||this.v||this.l?Js(this):this.kb())},qt.kb=function(){Js(this)},qt.isActive=function(){return!!this.g},qt.da=function(){try{return 2<ei(this)?this.g.status:-1}catch(t){return-1}},qt.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},qt.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ks(e)}},qt.Ia=function(){return this.m},qt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(qt=oi.prototype).ra=8,qt.H=1,qt.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new qn(this,this.l,t);let r=this.s;if(this.U&&(r?(r=Oe(r),Me(r,this.U)):r=this.U),null!==this.o||this.O||(i.I=r,r=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var s=this.j[n];if(void 0===(s="__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=fi(this,i,e),hs(n=as(this.I),"RID",t),hs(n,"CVER",22),this.F&&hs(n,"X-HTTP-Session-Id",this.F),di(this,n),r&&(this.O?e="headers="+encodeURIComponent(String(si(r)))+"&"+e:this.o&&ii(n,this.o,r)),xs(this.i,i),this.bb&&hs(n,"TYPE","init"),this.P?(hs(n,"$req",e),hs(n,"SID","null"),i.aa=!0,Gn(i,n,null)):Gn(i,n,e),this.H=2}}else 3==this.H&&(t?hi(this,t):0==this.j.length||ks(this.i)||hi(this))},qt.Ma=function(){if(this.u=null,yi(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Ln(Zt(this.jb,this),t)}},qt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,kn(10),ci(this),yi(this))},qt.ib=function(){null!=this.v&&(this.v=null,ci(this),gi(this),kn(19))},qt.pb=function(t){t?(this.l.info("Successfully pinged google.com"),kn(2)):(this.l.info("Failed to ping google.com"),kn(1))},qt.isActive=function(){return!!this.h&&this.h.isActive(this)},(qt=Ci.prototype).Ba=function(){},qt.Aa=function(){},qt.za=function(){},qt.ya=function(){},qt.isActive=function(){return!0},qt.Va=function(){},_i.prototype.g=function(t,e){return new Ai(t,e)},ee(Ai,Ye),Ai.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;kn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Ii(t,null,t.Y),li(t)},Ai.prototype.close=function(){ai(this.g)},Ai.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=tn(t),t=n);e.j.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.fb++,t)),3==e.H&&li(e)},Ai.prototype.N=function(){this.g.h=null,delete this.j,ai(this.g),delete this.g,Ai.$.N.call(this)},ee(Di,Bn),ee(ki,Un),ee(Ni,Ci),Ni.prototype.Ba=function(){Je(this.g,"a")},Ni.prototype.Aa=function(t){Je(this.g,new Di(t))},Ni.prototype.za=function(t){Je(this.g,new ki)},Ni.prototype.ya=function(){Je(this.g,"b")},ee(Li,(function(){this.blockSize=-1})),Li.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Li.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,s=this.m,i=this.h,r=0;r<e;){if(0==i)for(;r<=n;)xi(this,t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(s[i++]=t.charCodeAt(r++),i==this.blockSize){xi(this,s),i=0;break}}else for(;r<e;)if(s[i++]=t[r++],i==this.blockSize){xi(this,s),i=0;break}}this.h=i,this.i+=e},Li.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var s=0;32>s;s+=8)t[n++]=this.g[e]>>>s&255;return t};var Ri={};function Mi(t){return-128<=t&&128>t?function(t,e){var n=Ri;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new Oi([0|t],0>t?-1:0)}(t)}(t):new Oi([0|t],0>t?-1:0)}function Pi(t){if(isNaN(t)||!isFinite(t))return Vi;if(0>t)return $i(Pi(-t));for(var e=[],n=1,s=0;t>=n;s++)e[s]=t/n|0,n*=Fi;return new Oi(e,0)}var Fi=4294967296,Vi=Mi(0),Bi=Mi(1),Ui=Mi(16777216);function ji(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function qi(t){return-1==t.h}function $i(t){for(var e=t.g.length,n=[],s=0;s<e;s++)n[s]=~t.g[s];return new Oi(n,~t.h).add(Bi)}function zi(t,e){return t.add($i(e))}function Ki(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Hi(t,e){this.g=t,this.h=e}function Gi(t,e){if(ji(e))throw Error("division by zero");if(ji(t))return new Hi(Vi,Vi);if(qi(t))return e=Gi($i(t),e),new Hi($i(e.g),$i(e.h));if(qi(e))return e=Gi(t,$i(e)),new Hi($i(e.g),e.h);if(30<t.g.length){if(qi(t)||qi(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Bi,s=e;0>=s.X(t);)n=Qi(n),s=Qi(s);var i=Wi(n,1),r=Wi(s,1);for(s=Wi(s,2),n=Wi(n,2);!ji(s);){var o=r.add(s);0>=o.X(t)&&(i=i.add(n),r=o),s=Wi(s,1),n=Wi(n,1)}return e=zi(t,i.R(e)),new Hi(i,e)}for(i=Vi;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),s=48>=(s=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,s-48),o=(r=Pi(n)).R(e);qi(o)||0<o.X(t);)o=(r=Pi(n-=s)).R(e);ji(r)&&(r=Bi),i=i.add(r),t=zi(t,o)}return new Hi(i,t)}function Qi(t){for(var e=t.g.length+1,n=[],s=0;s<e;s++)n[s]=t.D(s)<<1|t.D(s-1)>>>31;return new Oi(n,t.h)}function Wi(t,e){var n=e>>5;e%=32;for(var s=t.g.length-n,i=[],r=0;r<s;r++)i[r]=0<e?t.D(r+n)>>>e|t.D(r+n+1)<<32-e:t.D(r+n);return new Oi(i,t.h)}(qt=Oi.prototype).ea=function(){if(qi(this))return-$i(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var s=this.D(n);t+=(0<=s?s:Fi+s)*e,e*=Fi}return t},qt.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(ji(this))return"0";if(qi(this))return"-"+$i(this).toString(t);for(var e=Pi(Math.pow(t,6)),n=this,s="";;){var i=Gi(n,e).g,r=((0<(n=zi(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(ji(n=i))return r+s;for(;6>r.length;)r="0"+r;s=r+s}},qt.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},qt.X=function(t){return qi(t=zi(this,t))?-1:ji(t)?0:1},qt.abs=function(){return qi(this)?$i(this):this},qt.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0,i=0;i<=e;i++){var r=s+(65535&this.D(i))+(65535&t.D(i)),o=(r>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);s=o>>>16,r&=65535,o&=65535,n[i]=o<<16|r}return new Oi(n,-2147483648&n[n.length-1]?-1:0)},qt.R=function(t){if(ji(this)||ji(t))return Vi;if(qi(this))return qi(t)?$i(this).R($i(t)):$i($i(this).R(t));if(qi(t))return $i(this.R($i(t)));if(0>this.X(Ui)&&0>t.X(Ui))return Pi(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],s=0;s<2*e;s++)n[s]=0;for(s=0;s<this.g.length;s++)for(var i=0;i<t.g.length;i++){var r=this.D(s)>>>16,o=65535&this.D(s),a=t.D(i)>>>16,c=65535&t.D(i);n[2*s+2*i]+=o*c,Ki(n,2*s+2*i),n[2*s+2*i+1]+=r*c,Ki(n,2*s+2*i+1),n[2*s+2*i+1]+=o*a,Ki(n,2*s+2*i+1),n[2*s+2*i+2]+=r*a,Ki(n,2*s+2*i+2)}for(s=0;s<e;s++)n[s]=n[2*s+1]<<16|n[2*s];for(s=e;s<2*e;s++)n[s]=0;return new Oi(n,0)},qt.gb=function(t){return Gi(this,t).h},qt.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0;s<e;s++)n[s]=this.D(s)&t.D(s);return new Oi(n,this.h&t.h)},qt.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0;s<e;s++)n[s]=this.D(s)|t.D(s);return new Oi(n,this.h|t.h)},qt.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],s=0;s<e;s++)n[s]=this.D(s)^t.D(s);return new Oi(n,this.h^t.h)},_i.prototype.createWebChannel=_i.prototype.g,Ai.prototype.send=Ai.prototype.u,Ai.prototype.open=Ai.prototype.m,Ai.prototype.close=Ai.prototype.close,xn.NO_ERROR=0,xn.TIMEOUT=8,xn.HTTP_ERROR=6,On.COMPLETE="complete",Pn.EventType=Vn,Vn.OPEN="a",Vn.CLOSE="b",Vn.ERROR="c",Vn.MESSAGE="d",Ye.prototype.listen=Ye.prototype.O,Hs.prototype.listenOnce=Hs.prototype.P,Hs.prototype.getLastError=Hs.prototype.Sa,Hs.prototype.getLastErrorCode=Hs.prototype.Ia,Hs.prototype.getStatus=Hs.prototype.da,Hs.prototype.getResponseJson=Hs.prototype.Wa,Hs.prototype.getResponseText=Hs.prototype.ja,Hs.prototype.send=Hs.prototype.ha,Hs.prototype.setWithCredentials=Hs.prototype.Oa,Li.prototype.digest=Li.prototype.l,Li.prototype.reset=Li.prototype.reset,Li.prototype.update=Li.prototype.j,Oi.prototype.add=Oi.prototype.add,Oi.prototype.multiply=Oi.prototype.R,Oi.prototype.modulo=Oi.prototype.gb,Oi.prototype.compare=Oi.prototype.X,Oi.prototype.toNumber=Oi.prototype.ea,Oi.prototype.toString=Oi.prototype.toString,Oi.prototype.getBits=Oi.prototype.D,Oi.fromNumber=Pi,Oi.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return $i(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var s=Pi(Math.pow(n,8)),i=Vi,r=0;r<e.length;r+=8){var o=Math.min(8,e.length-r),a=parseInt(e.substring(r,r+o),n);8>o?(o=Pi(Math.pow(n,o)),i=i.R(o).add(Pi(a))):i=(i=i.R(s)).add(Pi(a))}return i};var Xi=zt.createWebChannelTransport=function(){return new _i},Yi=zt.getStatEventTarget=function(){return Cn()},Ji=zt.ErrorCode=xn,Zi=zt.EventType=On,tr=zt.Event=In,er=zt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},nr=zt.FetchXmlHttpFactory=Bs,sr=zt.WebChannel=Pn,ir=zt.XhrIo=Hs,rr=zt.Md5=Li,or=zt.Integer=Oi;const ar="@firebase/firestore";class cr{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}cr.UNAUTHENTICATED=new cr(null),cr.GOOGLE_CREDENTIALS=new cr("google-credentials-uid"),cr.FIRST_PARTY=new cr("first-party-uid"),cr.MOCK_USER=new cr("mock-user");let ur="9.23.0";const lr=new Y("@firebase/firestore");function hr(){return lr.logLevel}function dr(t,...e){if(lr.logLevel<=K.DEBUG){const n=e.map(gr);lr.debug(`Firestore (${ur}): ${t}`,...n)}}function fr(t,...e){if(lr.logLevel<=K.ERROR){const n=e.map(gr);lr.error(`Firestore (${ur}): ${t}`,...n)}}function pr(t,...e){if(lr.logLevel<=K.WARN){const n=e.map(gr);lr.warn(`Firestore (${ur}): ${t}`,...n)}}function gr(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function mr(t="Unexpected state"){const e=`FIRESTORE (${ur}) INTERNAL ASSERTION FAILED: `+t;throw fr(e),new Error(e)}function yr(t,e){t||mr()}function vr(t,e){return t}const wr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class br extends k{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Er{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Tr{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Ir{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(cr.UNAUTHENTICATED)))}shutdown(){}}class Sr{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Cr{constructor(t){this.t=t,this.currentUser=cr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const s=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new Er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Er,t.enqueueRetryable((()=>s(this.currentUser)))};const r=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await s(this.currentUser)}))},o=t=>{dr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(dr("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Er)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(dr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(yr("string"==typeof e.accessToken),new Tr(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return yr(null===t||"string"==typeof t),new cr(t)}}class _r{constructor(t,e,n){this.h=t,this.l=e,this.m=n,this.type="FirstParty",this.user=cr.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const t=this.p();return t&&this.g.set("Authorization",t),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Ar{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new _r(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(cr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Dr{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kr{constructor(t){this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(t,e){const n=t=>{null!=t.error&&dr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.T;return this.T=t.token,dr("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const s=t=>{dr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.I.onInit((t=>s(t))),setTimeout((()=>{if(!this.appCheck){const t=this.I.getImmediate({optional:!0});t?s(t):dr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(yr("string"==typeof t.token),this.T=t.token,new Dr(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Nr(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Lr{static A(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=Nr(40);for(let s=0;s<n.length;++s)e.length<20&&n[s]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[s]%62))}return e}}function xr(t,e){return t<e?-1:t>e?1:0}function Or(t,e,n){return t.length===e.length&&t.every(((t,s)=>n(t,e[s])))}class Rr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new br(wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new br(wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new br(wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new br(wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Rr.fromMillis(Date.now())}static fromDate(t){return Rr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Rr(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?xr(this.nanoseconds,t.nanoseconds):xr(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Mr{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Mr(t)}static min(){return new Mr(new Rr(0,0))}static max(){return new Mr(new Rr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Pr{constructor(t,e,n){void 0===e?e=0:e>t.length&&mr(),void 0===n?n=t.length-e:n>t.length-e&&mr(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Pr.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Pr?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const n=t.get(s),i=e.get(s);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Fr extends Pr{construct(t,e,n){return new Fr(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new br(wr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Fr(e)}static emptyPath(){return new Fr([])}}const Vr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Br extends Pr{construct(t,e,n){return new Br(t,e,n)}static isValidIdentifier(t){return Vr.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Br.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Br(["__name__"])}static fromServerFormat(t){const e=[];let n="",s=0;const i=()=>{if(0===n.length)throw new br(wr.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;s<t.length;){const e=t[s];if("\\"===e){if(s+1===t.length)throw new br(wr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[s+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new br(wr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,s+=2}else"`"===e?(r=!r,s++):"."!==e||r?(n+=e,s++):(i(),s++)}if(i(),r)throw new br(wr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Br(e)}static emptyPath(){return new Br([])}}class Ur{constructor(t){this.path=t}static fromPath(t){return new Ur(Fr.fromString(t))}static fromName(t){return new Ur(Fr.fromString(t).popFirst(5))}static empty(){return new Ur(Fr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Fr.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Fr.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ur(new Fr(t.slice()))}}function jr(t){return new qr(t.readTime,t.key,-1)}class qr{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new qr(Mr.min(),Ur.empty(),-1)}static max(){return new qr(Mr.max(),Ur.empty(),-1)}}function $r(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Ur.comparator(t.documentKey,e.documentKey),0!==n?n:xr(t.largestBatchId,e.largestBatchId))}const zr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Kr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Hr(t){if(t.code!==wr.FAILED_PRECONDITION||t.message!==zr)throw t;dr("LocalStore","Unexpectedly lost primary lease")}class Gr{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&mr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Gr(((n,s)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,s)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Gr?e:Gr.resolve(e)}catch(t){return Gr.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Gr.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Gr.reject(e)}static resolve(t){return new Gr(((e,n)=>{e(t)}))}static reject(t){return new Gr(((e,n)=>{n(t)}))}static waitFor(t){return new Gr(((e,n)=>{let s=0,i=0,r=!1;t.forEach((t=>{++s,t.next((()=>{++i,r&&i===s&&e()}),(t=>n(t)))})),r=!0,i===s&&e()}))}static or(t){let e=Gr.resolve(!1);for(const n of t)e=e.next((t=>t?Gr.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,s)=>{n.push(e.call(this,t,s))})),this.waitFor(n)}static mapArray(t,e){return new Gr(((n,s)=>{const i=t.length,r=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;e(t[c]).next((t=>{r[c]=t,++o,o===i&&n(r)}),(t=>s(t)))}}))}static doWhile(t,e){return new Gr(((n,s)=>{const i=()=>{!0===t()?e().next((()=>{i()}),s):n()};i()}))}}function Qr(t){return"IndexedDbTransactionError"===t.name}class Wr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ot(t),this.ut=t=>e.writeSequenceNumber(t))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}function Xr(t){return null==t}function Yr(t){return 0===t&&1/t==-1/0}Wr.ct=-1;function Jr(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function to(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class eo{constructor(t,e){this.comparator=t,this.root=e||so.EMPTY}insert(t,e){return new eo(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,so.BLACK,null,null))}remove(t){return new eo(this.comparator,this.root.remove(t,this.comparator).copy(null,null,so.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(0===s)return e+n.left.size;s<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new no(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new no(this.root,t,this.comparator,!1)}getReverseIterator(){return new no(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new no(this.root,t,this.comparator,!0)}}class no{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class so{constructor(t,e,n,s,i){this.key=t,this.value=e,this.color=null!=n?n:so.RED,this.left=null!=s?s:so.EMPTY,this.right=null!=i?i:so.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,s,i){return new so(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const i=n(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,n),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return so.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return so.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,so.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,so.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mr();if(this.right.isRed())throw mr();const t=this.left.check();if(t!==this.right.check())throw mr();return t+(this.isRed()?0:1)}}so.EMPTY=null,so.RED=!0,so.BLACK=!1,so.EMPTY=new class{constructor(){this.size=0}get key(){throw mr()}get value(){throw mr()}get color(){throw mr()}get left(){throw mr()}get right(){throw mr()}copy(t,e,n,s,i){return this}insert(t,e,n){return new so(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class io{constructor(t){this.comparator=t,this.data=new eo(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new ro(this.data.getIterator())}getIteratorFrom(t){return new ro(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof io))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(0!==this.comparator(t,s))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new io(this.comparator);return e.data=t,e}}class ro{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class oo{constructor(t){this.fields=t,t.sort(Br.comparator)}static empty(){return new oo([])}unionWith(t){let e=new io(Br.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new oo(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Or(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class ao extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class co{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new ao("Invalid base64 string: "+t):t}}(t);return new co(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new co(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return xr(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}co.EMPTY_BYTE_STRING=new co("");const uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(t){if(yr(!!t),"string"==typeof t){let e=0;const n=uo.exec(t);if(yr(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:ho(t.seconds),nanos:ho(t.nanos)}}function ho(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function fo(t){return"string"==typeof t?co.fromBase64String(t):co.fromUint8Array(t)}function po(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function go(t){const e=t.mapValue.fields.__previous_value__;return po(e)?go(e):e}function mo(t){const e=lo(t.mapValue.fields.__local_write_time__.timestampValue);return new Rr(e.seconds,e.nanos)}class yo{constructor(t,e,n,s,i,r,o,a,c){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class vo{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new vo("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof vo&&t.projectId===this.projectId&&t.database===this.database}}const wo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function bo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:Oo(t)?9007199254740991:10:mr()}function Eo(t,e){if(t===e)return!0;const n=bo(t);if(n!==bo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mo(t).isEqual(mo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=lo(t.timestampValue),s=lo(e.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return fo(t.bytesValue).isEqual(fo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ho(t.geoPointValue.latitude)===ho(e.geoPointValue.latitude)&&ho(t.geoPointValue.longitude)===ho(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ho(t.integerValue)===ho(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=ho(t.doubleValue),s=ho(e.doubleValue);return n===s?Yr(n)===Yr(s):isNaN(n)&&isNaN(s)}return!1}(t,e);case 9:return Or(t.arrayValue.values||[],e.arrayValue.values||[],Eo);case 10:return function(t,e){const n=t.mapValue.fields||{},s=e.mapValue.fields||{};if(Jr(n)!==Jr(s))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===s[t]||!Eo(n[t],s[t])))return!1;return!0}(t,e);default:return mr()}}function To(t,e){return void 0!==(t.values||[]).find((t=>Eo(t,e)))}function Io(t,e){if(t===e)return 0;const n=bo(t),s=bo(e);if(n!==s)return xr(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return xr(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=ho(t.integerValue||t.doubleValue),s=ho(e.integerValue||e.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(t,e);case 3:return So(t.timestampValue,e.timestampValue);case 4:return So(mo(t),mo(e));case 5:return xr(t.stringValue,e.stringValue);case 6:return function(t,e){const n=fo(t),s=fo(e);return n.compareTo(s)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),s=e.split("/");for(let t=0;t<n.length&&t<s.length;t++){const e=xr(n[t],s[t]);if(0!==e)return e}return xr(n.length,s.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=xr(ho(t.latitude),ho(e.latitude));return 0!==n?n:xr(ho(t.longitude),ho(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],s=e.values||[];for(let t=0;t<n.length&&t<s.length;++t){const e=Io(n[t],s[t]);if(e)return e}return xr(n.length,s.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===wo.mapValue&&e===wo.mapValue)return 0;if(t===wo.mapValue)return 1;if(e===wo.mapValue)return-1;const n=t.fields||{},s=Object.keys(n),i=e.fields||{},r=Object.keys(i);s.sort(),r.sort();for(let t=0;t<s.length&&t<r.length;++t){const e=xr(s[t],r[t]);if(0!==e)return e;const o=Io(n[s[t]],i[r[t]]);if(0!==o)return o}return xr(s.length,r.length)}(t.mapValue,e.mapValue);default:throw mr()}}function So(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xr(t,e);const n=lo(t),s=lo(e),i=xr(n.seconds,s.seconds);return 0!==i?i:xr(n.nanos,s.nanos)}function Co(t){return _o(t)}function _o(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=lo(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?fo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ur.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const s of t.values||[])n?n=!1:e+=",",e+=_o(s);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",s=!0;for(const i of e)s?s=!1:n+=",",n+=`${i}:${_o(t.fields[i])}`;return n+"}"}(t.mapValue):mr();var e,n}function Ao(t){return!!t&&"integerValue"in t}function Do(t){return!!t&&"arrayValue"in t}function ko(t){return!!t&&"nullValue"in t}function No(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lo(t){return!!t&&"mapValue"in t}function xo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Zr(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=xo(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=xo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Oo(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Ro{constructor(t){this.value=t}static empty(){return new Ro({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Lo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=xo(e)}setAll(t){let e=Br.emptyPath(),n={},s=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,s),n={},s=[],e=i.popLast()}t?n[i.lastSegment()]=xo(t):s.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,s)}delete(t){const e=this.field(t.popLast());Lo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Eo(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=e.mapValue.fields[t.get(n)];Lo(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,n){Zr(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Ro(xo(this.value))}}function Mo(t){const e=[];return Zr(t.fields,((t,n)=>{const s=new Br([t]);if(Lo(n)){const t=Mo(n.mapValue).fields;if(0===t.length)e.push(s);else for(const n of t)e.push(s.child(n))}else e.push(s)})),new oo(e)}class Po{constructor(t,e,n,s,i,r,o){this.key=t,this.documentType=e,this.version=n,this.readTime=s,this.createTime=i,this.data=r,this.documentState=o}static newInvalidDocument(t){return new Po(t,0,Mr.min(),Mr.min(),Mr.min(),Ro.empty(),0)}static newFoundDocument(t,e,n,s){return new Po(t,1,e,Mr.min(),n,s,0)}static newNoDocument(t,e){return new Po(t,2,e,Mr.min(),Mr.min(),Ro.empty(),0)}static newUnknownDocument(t,e){return new Po(t,3,e,Mr.min(),Mr.min(),Ro.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Mr.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ro.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ro.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mr.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Po&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Po(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fo{constructor(t,e){this.position=t,this.inclusive=e}}function Vo(t,e,n){let s=0;for(let i=0;i<t.position.length;i++){const r=e[i],o=t.position[i];if(s=r.field.isKeyField()?Ur.comparator(Ur.fromName(o.referenceValue),n.key):Io(o,n.data.field(r.field)),"desc"===r.dir&&(s*=-1),0!==s)break}return s}function Bo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Eo(t.position[n],e.position[n]))return!1;return!0}class Uo{constructor(t,e="asc"){this.field=t,this.dir=e}}function jo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class qo{}class $o extends qo{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Xo(t,e,n):"array-contains"===e?new ta(t,n):"in"===e?new ea(t,n):"not-in"===e?new na(t,n):"array-contains-any"===e?new sa(t,n):new $o(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Yo(t,n):new Jo(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Io(e,this.value)):null!==e&&bo(this.value)===bo(e)&&this.matchesComparison(Io(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return mr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class zo extends qo{constructor(t,e){super(),this.filters=t,this.op=e,this.lt=null}static create(t,e){return new zo(t,e)}matches(t){return Ko(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.ft((t=>t.isInequality()));return null!==t?t.field:null}ft(t){for(const e of this.getFlattenedFilters())if(t(e))return e;return null}}function Ko(t){return"and"===t.op}function Ho(t){return function(t){for(const e of t.filters)if(e instanceof zo)return!1;return!0}(t)&&Ko(t)}function Go(t){if(t instanceof $o)return t.field.canonicalString()+t.op.toString()+Co(t.value);if(Ho(t))return t.filters.map((t=>Go(t))).join(",");{const e=t.filters.map((t=>Go(t))).join(",");return`${t.op}(${e})`}}function Qo(t,e){return t instanceof $o?function(t,e){return e instanceof $o&&t.op===e.op&&t.field.isEqual(e.field)&&Eo(t.value,e.value)}(t,e):t instanceof zo?function(t,e){return e instanceof zo&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,s)=>t&&Qo(n,e.filters[s])),!0)}(t,e):void mr()}function Wo(t){return t instanceof $o?function(t){return`${t.field.canonicalString()} ${t.op} ${Co(t.value)}`}(t):t instanceof zo?function(t){return t.op.toString()+" {"+t.getFilters().map(Wo).join(" ,")+"}"}(t):"Filter"}class Xo extends $o{constructor(t,e,n){super(t,e,n),this.key=Ur.fromName(n.referenceValue)}matches(t){const e=Ur.comparator(t.key,this.key);return this.matchesComparison(e)}}class Yo extends $o{constructor(t,e){super(t,"in",e),this.keys=Zo(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Jo extends $o{constructor(t,e){super(t,"not-in",e),this.keys=Zo(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Zo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Ur.fromName(t.referenceValue)))}class ta extends $o{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Do(e)&&To(e.arrayValue,this.value)}}class ea extends $o{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&To(this.value.arrayValue,e)}}class na extends $o{constructor(t,e){super(t,"not-in",e)}matches(t){if(To(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!To(this.value.arrayValue,e)}}class sa extends $o{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Do(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>To(this.value.arrayValue,t)))}}class ia{constructor(t,e=null,n=[],s=[],i=null,r=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=r,this.endAt=o,this.dt=null}}function ra(t,e=null,n=[],s=[],i=null,r=null,o=null){return new ia(t,e,n,s,i,r,o)}function oa(t){const e=vr(t);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Go(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Xr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Co(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Co(t))).join(",")),e.dt=t}return e.dt}function aa(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!jo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Qo(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bo(t.startAt,e.startAt)&&Bo(t.endAt,e.endAt)}function ca(t){return Ur.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class ua{constructor(t,e=null,n=[],s=[],i=null,r="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=r,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function la(t){return new ua(t)}function ha(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function da(t){const e=vr(t);if(null===e.wt){e.wt=[];const t=function(t){for(const e of t.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new Uo(t)),e.wt.push(new Uo(Br.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.wt.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Uo(Br.keyField(),t))}}}return e.wt}function fa(t){const e=vr(t);if(!e._t)if("F"===e.limitType)e._t=ra(e.path,e.collectionGroup,da(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of da(e)){const e="desc"===n.dir?"asc":"desc";t.push(new Uo(n.field,e))}const n=e.endAt?new Fo(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Fo(e.startAt.position,e.startAt.inclusive):null;e._t=ra(e.path,e.collectionGroup,t,e.filters,e.limit,n,s)}return e._t}function pa(t,e,n){return new ua(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ga(t,e){return aa(fa(t),fa(e))&&t.limitType===e.limitType}function ma(t){return`${oa(fa(t))}|lt:${t.limitType}`}function ya(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Wo(t))).join(", ")}]`),Xr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Co(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Co(t))).join(",")),`Target(${e})`}(fa(t))}; limitType=${t.limitType})`}function va(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ur.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of da(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const s=Vo(t,e,n);return t.inclusive?s<=0:s<0}(t.startAt,da(t),e)||t.endAt&&!function(t,e,n){const s=Vo(t,e,n);return t.inclusive?s>=0:s>0}(t.endAt,da(t),e))}(t,e)}function wa(t){return(e,n)=>{let s=!1;for(const i of da(t)){const t=ba(i,e,n);if(0!==t)return t;s=s||i.field.isKeyField()}return 0}}function ba(t,e,n){const s=t.field.isKeyField()?Ur.comparator(e.key,n.key):function(t,e,n){const s=e.data.field(t),i=n.data.field(t);return null!==s&&null!==i?Io(s,i):mr()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return mr()}}class Ea{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,s]of n)if(this.equalsFn(e,t))return s}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),s=this.inner[n];if(void 0===s)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<s.length;n++)if(this.equalsFn(s[n][0],t))return void(s[n]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return 1===n.length?delete this.inner[e]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Zr(this.inner,((e,n)=>{for(const[e,s]of n)t(e,s)}))}isEmpty(){return to(this.inner)}size(){return this.innerSize}}const Ta=new eo(Ur.comparator);function Ia(){return Ta}const Sa=new eo(Ur.comparator);function Ca(...t){let e=Sa;for(const n of t)e=e.insert(n.key,n);return e}function _a(t){let e=Sa;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Aa(){return ka()}function Da(){return ka()}function ka(){return new Ea((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Na=new eo(Ur.comparator),La=new io(Ur.comparator);function xa(...t){let e=La;for(const n of t)e=e.add(n);return e}const Oa=new io(xr);function Ra(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yr(e)?"-0":e}}function Ma(t){return{integerValue:""+t}}function Pa(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Yr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Ma(e):Ra(t,e)}class Fa{constructor(){this._=void 0}}function Va(t,e,n){return t instanceof ja?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&po(e)&&(e=go(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof qa?$a(t,e):t instanceof za?Ka(t,e):function(t,e){const n=Ua(t,e),s=Ga(n)+Ga(t.gt);return Ao(n)&&Ao(t.gt)?Ma(s):Ra(t.serializer,s)}(t,e)}function Ba(t,e,n){return t instanceof qa?$a(t,e):t instanceof za?Ka(t,e):n}function Ua(t,e){return t instanceof Ha?Ao(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class ja extends Fa{}class qa extends Fa{constructor(t){super(),this.elements=t}}function $a(t,e){const n=Qa(e);for(const e of t.elements)n.some((t=>Eo(t,e)))||n.push(e);return{arrayValue:{values:n}}}class za extends Fa{constructor(t){super(),this.elements=t}}function Ka(t,e){let n=Qa(e);for(const e of t.elements)n=n.filter((t=>!Eo(t,e)));return{arrayValue:{values:n}}}class Ha extends Fa{constructor(t,e){super(),this.serializer=t,this.gt=e}}function Ga(t){return ho(t.integerValue||t.doubleValue)}function Qa(t){return Do(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Wa{constructor(t,e){this.version=t,this.transformResults=e}}class Xa{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Xa}static exists(t){return new Xa(void 0,t)}static updateTime(t){return new Xa(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Ya(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Ja{}function Za(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new uc(t.key,Xa.none()):new ic(t.key,t.data,Xa.none());{const n=t.data,s=Ro.empty();let i=new io(Br.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?s.delete(t):s.set(t,e),i=i.add(t)}return new rc(t.key,s,new oo(i.toArray()),Xa.none())}}function tc(t,e,n){t instanceof ic?function(t,e,n){const s=t.value.clone(),i=ac(t.fieldTransforms,e,n.transformResults);s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):t instanceof rc?function(t,e,n){if(!Ya(t.precondition,e))return void e.convertToUnknownDocument(n.version);const s=ac(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(oc(t)),i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ec(t,e,n,s){return t instanceof ic?function(t,e,n,s){if(!Ya(t.precondition,e))return n;const i=t.value.clone(),r=cc(t.fieldTransforms,s,e);return i.setAll(r),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,s):t instanceof rc?function(t,e,n,s){if(!Ya(t.precondition,e))return n;const i=cc(t.fieldTransforms,s,e),r=e.data;return r.setAll(oc(t)),r.setAll(i),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,s):function(t,e,n){return Ya(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function nc(t,e){let n=null;for(const s of t.fieldTransforms){const t=e.data.field(s.field),i=Ua(s.transform,t||null);null!=i&&(null===n&&(n=Ro.empty()),n.set(s.field,i))}return n||null}function sc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Or(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof qa&&e instanceof qa||t instanceof za&&e instanceof za?Or(t.elements,e.elements,Eo):t instanceof Ha&&e instanceof Ha?Eo(t.gt,e.gt):t instanceof ja&&e instanceof ja}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ic extends Ja{constructor(t,e,n,s=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class rc extends Ja{constructor(t,e,n,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function oc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}})),e}function ac(t,e,n){const s=new Map;yr(t.length===n.length);for(let i=0;i<n.length;i++){const r=t[i],o=r.transform,a=e.data.field(r.field);s.set(r.field,Ba(o,a,n[i]))}return s}function cc(t,e,n){const s=new Map;for(const i of t){const t=i.transform,r=n.data.field(i.field);s.set(i.field,Va(t,r,e))}return s}class uc extends Ja{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lc extends Ja{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class hc{constructor(t,e,n,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const s=this.mutations[e];s.key.isEqual(t.key)&&tc(s,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=ec(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=ec(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Da();return this.mutations.forEach((s=>{const i=t.get(s.key),r=i.overlayedDocument;let o=this.applyToLocalView(r,i.mutatedFields);o=e.has(s.key)?null:o;const a=Za(r,o);null!==a&&n.set(s.key,a),r.isValidDocument()||r.convertToNoDocument(Mr.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),xa())}isEqual(t){return this.batchId===t.batchId&&Or(this.mutations,t.mutations,((t,e)=>sc(t,e)))&&Or(this.baseMutations,t.baseMutations,((t,e)=>sc(t,e)))}}class dc{constructor(t,e,n,s){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=s}static from(t,e,n){yr(t.mutations.length===n.length);let s=Na;const i=t.mutations;for(let t=0;t<i.length;t++)s=s.insert(i[t].key,n[t].version);return new dc(t,e,n,s)}}class fc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class pc{constructor(t,e){this.count=t,this.unchangedNames=e}}var gc,mc;function yc(t){if(void 0===t)return fr("GRPC error has no .code"),wr.UNKNOWN;switch(t){case gc.OK:return wr.OK;case gc.CANCELLED:return wr.CANCELLED;case gc.UNKNOWN:return wr.UNKNOWN;case gc.DEADLINE_EXCEEDED:return wr.DEADLINE_EXCEEDED;case gc.RESOURCE_EXHAUSTED:return wr.RESOURCE_EXHAUSTED;case gc.INTERNAL:return wr.INTERNAL;case gc.UNAVAILABLE:return wr.UNAVAILABLE;case gc.UNAUTHENTICATED:return wr.UNAUTHENTICATED;case gc.INVALID_ARGUMENT:return wr.INVALID_ARGUMENT;case gc.NOT_FOUND:return wr.NOT_FOUND;case gc.ALREADY_EXISTS:return wr.ALREADY_EXISTS;case gc.PERMISSION_DENIED:return wr.PERMISSION_DENIED;case gc.FAILED_PRECONDITION:return wr.FAILED_PRECONDITION;case gc.ABORTED:return wr.ABORTED;case gc.OUT_OF_RANGE:return wr.OUT_OF_RANGE;case gc.UNIMPLEMENTED:return wr.UNIMPLEMENTED;case gc.DATA_LOSS:return wr.DATA_LOSS;default:return mr()}}(mc=gc||(gc={}))[mc.OK=0]="OK",mc[mc.CANCELLED=1]="CANCELLED",mc[mc.UNKNOWN=2]="UNKNOWN",mc[mc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mc[mc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mc[mc.NOT_FOUND=5]="NOT_FOUND",mc[mc.ALREADY_EXISTS=6]="ALREADY_EXISTS",mc[mc.PERMISSION_DENIED=7]="PERMISSION_DENIED",mc[mc.UNAUTHENTICATED=16]="UNAUTHENTICATED",mc[mc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mc[mc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mc[mc.ABORTED=10]="ABORTED",mc[mc.OUT_OF_RANGE=11]="OUT_OF_RANGE",mc[mc.UNIMPLEMENTED=12]="UNIMPLEMENTED",mc[mc.INTERNAL=13]="INTERNAL",mc[mc.UNAVAILABLE=14]="UNAVAILABLE",mc[mc.DATA_LOSS=15]="DATA_LOSS";class vc{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return wc}static getOrCreateInstance(){return null===wc&&(wc=new vc),wc}onExistenceFilterMismatch(t){const e=Symbol();return this.onExistenceFilterMismatchCallbacks.set(e,t),()=>this.onExistenceFilterMismatchCallbacks.delete(e)}notifyOnExistenceFilterMismatch(t){this.onExistenceFilterMismatchCallbacks.forEach((e=>e(t)))}}let wc=null;const bc=new or([4294967295,4294967295],0);function Ec(t){const e=(new TextEncoder).encode(t),n=new rr;return n.update(e),new Uint8Array(n.digest())}function Tc(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new or([n,s],0),new or([i,r],0)]}class Ic{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Sc(`Invalid padding: ${e}`);if(n<0)throw new Sc(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new Sc(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new Sc(`Invalid padding when bitmap length is 0: ${e}`);this.It=8*t.length-e,this.Tt=or.fromNumber(this.It)}Et(t,e,n){let s=t.add(e.multiply(or.fromNumber(n)));return 1===s.compare(bc)&&(s=new or([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Tt).toNumber()}At(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}vt(t){if(0===this.It)return!1;const e=Ec(t),[n,s]=Tc(e);for(let t=0;t<this.hashCount;t++){const e=this.Et(n,s,t);if(!this.At(e))return!1}return!0}static create(t,e,n){const s=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),r=new Ic(i,s,e);return n.forEach((t=>r.insert(t))),r}insert(t){if(0===this.It)return;const e=Ec(t),[n,s]=Tc(e);for(let t=0;t<this.hashCount;t++){const e=this.Et(n,s,t);this.Rt(e)}}Rt(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Cc{constructor(t,e,n,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const s=new Map;return s.set(t,_c.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Cc(Mr.min(),s,new eo(xr),Ia(),xa())}}class _c{constructor(t,e,n,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new _c(n,e,xa(),xa(),xa())}}class Ac{constructor(t,e,n,s){this.Pt=t,this.removedTargetIds=e,this.key=n,this.bt=s}}class Dc{constructor(t,e){this.targetId=t,this.Vt=e}}class kc{constructor(t,e,n=co.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=s}}class Nc{constructor(){this.St=0,this.Dt=Oc(),this.Ct=co.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(t){t.approximateByteSize()>0&&(this.Nt=!0,this.Ct=t)}Ot(){let t=xa(),e=xa(),n=xa();return this.Dt.forEach(((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:n=n.add(s);break;default:mr()}})),new _c(this.Ct,this.xt,t,e,n)}Ft(){this.Nt=!1,this.Dt=Oc()}Bt(t,e){this.Nt=!0,this.Dt=this.Dt.insert(t,e)}Lt(t){this.Nt=!0,this.Dt=this.Dt.remove(t)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Lc{constructor(t){this.Gt=t,this.Qt=new Map,this.jt=Ia(),this.zt=xc(),this.Wt=new eo(xr)}Ht(t){for(const e of t.Pt)t.bt&&t.bt.isFoundDocument()?this.Jt(e,t.bt):this.Yt(e,t.key,t.bt);for(const e of t.removedTargetIds)this.Yt(e,t.key,t.bt)}Xt(t){this.forEachTarget(t,(e=>{const n=this.Zt(e);switch(t.state){case 0:this.te(e)&&n.$t(t.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(t.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(e);break;case 3:this.te(e)&&(n.Kt(),n.$t(t.resumeToken));break;case 4:this.te(e)&&(this.ee(e),n.$t(t.resumeToken));break;default:mr()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Qt.forEach(((t,n)=>{this.te(n)&&e(n)}))}ne(t){var e;const n=t.targetId,s=t.Vt.count,i=this.se(n);if(i){const r=i.target;if(ca(r))if(0===s){const t=new Ur(r.path);this.Yt(n,t,Po.newNoDocument(t,Mr.min()))}else yr(1===s);else{const i=this.ie(n);if(i!==s){const s=this.re(t,i);if(0!==s){this.ee(n);const t=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,t)}null===(e=vc.instance)||void 0===e||e.notifyOnExistenceFilterMismatch(function(t,e,n){var s,i,r,o,a,c;const u={localCacheCount:e,existenceFilterCount:n.count},l=n.unchangedNames;return l&&(u.bloomFilter={applied:0===t,hashCount:null!==(s=null==l?void 0:l.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(o=null===(r=null===(i=null==l?void 0:l.bits)||void 0===i?void 0:i.bitmap)||void 0===r?void 0:r.length)&&void 0!==o?o:0,padding:null!==(c=null===(a=null==l?void 0:l.bits)||void 0===a?void 0:a.padding)&&void 0!==c?c:0}),u}(s,i,t.Vt))}}}}re(t,e){const{unchangedNames:n,count:s}=t.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=n;let a,c;try{a=fo(i).toUint8Array()}catch(t){if(t instanceof ao)return pr("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw t}try{c=new Ic(a,r,o)}catch(t){return pr(t instanceof Sc?"BloomFilter error: ":"Applying bloom filter failed: ",t),1}return 0===c.It?1:s!==e-this.oe(t.targetId,c)?2:0}oe(t,e){const n=this.Gt.getRemoteKeysForTarget(t);let s=0;return n.forEach((n=>{const i=this.Gt.ue(),r=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.vt(r)||(this.Yt(t,n,null),s++)})),s}ce(t){const e=new Map;this.Qt.forEach(((n,s)=>{const i=this.se(s);if(i){if(n.current&&ca(i.target)){const e=new Ur(i.target.path);null!==this.jt.get(e)||this.ae(s,e)||this.Yt(s,e,Po.newNoDocument(e,t))}n.Mt&&(e.set(s,n.Ot()),n.Ft())}}));let n=xa();this.zt.forEach(((t,e)=>{let s=!0;e.forEachWhile((t=>{const e=this.se(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(s=!1,!1)})),s&&(n=n.add(t))})),this.jt.forEach(((e,n)=>n.setReadTime(t)));const s=new Cc(t,e,this.Wt,this.jt,n);return this.jt=Ia(),this.zt=xc(),this.Wt=new eo(xr),s}Jt(t,e){if(!this.te(t))return;const n=this.ae(t,e.key)?2:0;this.Zt(t).Bt(e.key,n),this.jt=this.jt.insert(e.key,e),this.zt=this.zt.insert(e.key,this.he(e.key).add(t))}Yt(t,e,n){if(!this.te(t))return;const s=this.Zt(t);this.ae(t,e)?s.Bt(e,1):s.Lt(e),this.zt=this.zt.insert(e,this.he(e).delete(t)),n&&(this.jt=this.jt.insert(e,n))}removeTarget(t){this.Qt.delete(t)}ie(t){const e=this.Zt(t).Ot();return this.Gt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}qt(t){this.Zt(t).qt()}Zt(t){let e=this.Qt.get(t);return e||(e=new Nc,this.Qt.set(t,e)),e}he(t){let e=this.zt.get(t);return e||(e=new io(xr),this.zt=this.zt.insert(t,e)),e}te(t){const e=null!==this.se(t);return e||dr("WatchChangeAggregator","Detected inactive target",t),e}se(t){const e=this.Qt.get(t);return e&&e.kt?null:this.Gt.le(t)}ee(t){this.Qt.set(t,new Nc),this.Gt.getRemoteKeysForTarget(t).forEach((e=>{this.Yt(t,e,null)}))}ae(t,e){return this.Gt.getRemoteKeysForTarget(t).has(e)}}function xc(){return new eo(Ur.comparator)}function Oc(){return new eo(Ur.comparator)}const Rc={asc:"ASCENDING",desc:"DESCENDING"},Mc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pc={and:"AND",or:"OR"};class Fc{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Vc(t,e){return t.useProto3Json||Xr(e)?e:{value:e}}function Bc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uc(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function jc(t,e){return Bc(t,e.toTimestamp())}function qc(t){return yr(!!t),Mr.fromTimestamp(function(t){const e=lo(t);return new Rr(e.seconds,e.nanos)}(t))}function $c(t,e){return function(t){return new Fr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function zc(t){const e=Fr.fromString(t);return yr(cu(e)),e}function Kc(t,e){return $c(t.databaseId,e.path)}function Hc(t,e){const n=zc(e);if(n.get(1)!==t.databaseId.projectId)throw new br(wr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new br(wr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ur(Wc(n))}function Gc(t,e){return $c(t.databaseId,e)}function Qc(t){return new Fr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Wc(t){return yr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Xc(t,e,n){return{name:Kc(t,e),fields:n.value.mapValue.fields}}function Yc(t,e){return{documents:[Gc(t,e.path)]}}function Jc(t,e){const n={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(n.parent=Gc(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Gc(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const i=function(t){if(0!==t.length)return ou(zo.create(t,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const r=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:iu(t.field),direction:eu(t.dir)}}(t)))}(e.orderBy);r&&(n.structuredQuery.orderBy=r);const o=Vc(t,e.limit);var a;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function Zc(t){let e=function(t){const e=zc(t);return 4===e.length?Fr.emptyPath():Wc(e)}(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let i=null;if(s>0){yr(1===s);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=function(t){const e=tu(t);return e instanceof zo&&Ho(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new Uo(ru(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Xr(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Fo(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new Fo(n,e)}(n.endAt)),function(t,e,n,s,i,r,o,a){return new ua(t,e,n,s,i,r,o,a)}(e,i,o,r,a,"F",c,u)}function tu(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=ru(t.unaryFilter.field);return $o.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=ru(t.unaryFilter.field);return $o.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ru(t.unaryFilter.field);return $o.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ru(t.unaryFilter.field);return $o.create(i,"!=",{nullValue:"NULL_VALUE"});default:return mr()}}(t):void 0!==t.fieldFilter?function(t){return $o.create(ru(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return mr()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return zo.create(t.compositeFilter.filters.map((t=>tu(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return mr()}}(t.compositeFilter.op))}(t):mr()}function eu(t){return Rc[t]}function nu(t){return Mc[t]}function su(t){return Pc[t]}function iu(t){return{fieldPath:t.canonicalString()}}function ru(t){return Br.fromServerFormat(t.fieldPath)}function ou(t){return t instanceof $o?function(t){if("=="===t.op){if(No(t.value))return{unaryFilter:{field:iu(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:iu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(No(t.value))return{unaryFilter:{field:iu(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:iu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:iu(t.field),op:nu(t.op),value:t.value}}}(t):t instanceof zo?function(t){const e=t.getFilters().map((t=>ou(t)));return 1===e.length?e[0]:{compositeFilter:{op:su(t.op),filters:e}}}(t):mr()}function au(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function cu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class uu{constructor(t,e,n,s,i=Mr.min(),r=Mr.min(),o=co.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new uu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new uu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new uu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new uu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class lu{constructor(t){this.fe=t}}function hu(t){const e=Zc({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?pa(e,e.limit,"L"):e}class du{constructor(){}_e(t,e){this.me(t,e),e.ge()}me(t,e){if("nullValue"in t)this.ye(e,5);else if("booleanValue"in t)this.ye(e,10),e.pe(t.booleanValue?1:0);else if("integerValue"in t)this.ye(e,15),e.pe(ho(t.integerValue));else if("doubleValue"in t){const n=ho(t.doubleValue);isNaN(n)?this.ye(e,13):(this.ye(e,15),Yr(n)?e.pe(0):e.pe(n))}else if("timestampValue"in t){const n=t.timestampValue;this.ye(e,20),"string"==typeof n?e.Ie(n):(e.Ie(`${n.seconds||""}`),e.pe(n.nanos||0))}else if("stringValue"in t)this.Te(t.stringValue,e),this.Ee(e);else if("bytesValue"in t)this.ye(e,30),e.Ae(fo(t.bytesValue)),this.Ee(e);else if("referenceValue"in t)this.ve(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.ye(e,45),e.pe(n.latitude||0),e.pe(n.longitude||0)}else"mapValue"in t?Oo(t)?this.ye(e,Number.MAX_SAFE_INTEGER):(this.Re(t.mapValue,e),this.Ee(e)):"arrayValue"in t?(this.Pe(t.arrayValue,e),this.Ee(e)):mr()}Te(t,e){this.ye(e,25),this.be(t,e)}be(t,e){e.Ie(t)}Re(t,e){const n=t.fields||{};this.ye(e,55);for(const t of Object.keys(n))this.Te(t,e),this.me(n[t],e)}Pe(t,e){const n=t.values||[];this.ye(e,50);for(const t of n)this.me(t,e)}ve(t,e){this.ye(e,37),Ur.fromName(t).path.forEach((t=>{this.ye(e,60),this.be(t,e)}))}ye(t,e){t.pe(e)}Ee(t){t.pe(2)}}du.Ve=new du;class fu{constructor(){this.rn=new pu}addToCollectionParentIndex(t,e){return this.rn.add(e),Gr.resolve()}getCollectionParents(t,e){return Gr.resolve(this.rn.getEntries(e))}addFieldIndex(t,e){return Gr.resolve()}deleteFieldIndex(t,e){return Gr.resolve()}getDocumentsMatchingTarget(t,e){return Gr.resolve(null)}getIndexType(t,e){return Gr.resolve(0)}getFieldIndexes(t,e){return Gr.resolve([])}getNextCollectionGroupToUpdate(t){return Gr.resolve(null)}getMinOffset(t,e){return Gr.resolve(qr.min())}getMinOffsetFromCollectionGroup(t,e){return Gr.resolve(qr.min())}updateCollectionGroup(t,e,n){return Gr.resolve()}updateIndexEntries(t,e){return Gr.resolve()}}class pu{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e]||new io(Fr.comparator),i=!s.has(n);return this.index[e]=s.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e];return s&&s.has(n)}getEntries(t){return(this.index[t]||new io(Fr.comparator)).toArray()}}new Uint8Array(0);class gu{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new gu(t,gu.DEFAULT_COLLECTION_PERCENTILE,gu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}gu.DEFAULT_COLLECTION_PERCENTILE=10,gu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gu.DEFAULT=new gu(41943040,gu.DEFAULT_COLLECTION_PERCENTILE,gu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gu.DISABLED=new gu(-1,0,0);class mu{constructor(t){this.Nn=t}next(){return this.Nn+=2,this.Nn}static kn(){return new mu(0)}static Mn(){return new mu(-1)}}class yu{constructor(){this.changes=new Ea((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Po.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Gr.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class vu{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class wu{constructor(t,e,n,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(n=s,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&ec(n.mutation,t,oo.empty(),Rr.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,xa()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=xa()){const s=Aa();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,n).next((t=>{let e=Ca();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Aa();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,xa())))}populateOverlays(t,e,n){const s=[];return n.forEach((t=>{e.has(t)||s.push(t)})),this.documentOverlayCache.getOverlays(t,s).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,s){let i=Ia();const r=ka(),o=ka();return e.forEach(((t,e)=>{const o=n.get(e.key);s.has(e.key)&&(void 0===o||o.mutation instanceof rc)?i=i.insert(e.key,e):void 0!==o?(r.set(e.key,o.mutation.getFieldMask()),ec(o.mutation,e,o.mutation.getFieldMask(),Rr.now())):r.set(e.key,oo.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new vu(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=ka();let s=new eo(((t,e)=>t-e)),i=xa();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let o=n.get(t)||oo.empty();o=i.applyToLocalView(r,o),n.set(t,o);const a=(s.get(i.batchId)||xa()).add(t);s=s.insert(i.batchId,a)}))})).next((()=>{const r=[],o=s.getReverseIterator();for(;o.hasNext();){const s=o.getNext(),a=s.key,c=s.value,u=Da();c.forEach((t=>{if(!i.has(t)){const s=Za(e.get(t),n.get(t));null!==s&&u.set(t,s),i=i.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,a,u))}return Gr.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Ur.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,s).next((i=>{const r=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,s-i.size):Gr.resolve(Aa());let o=-1,a=i;return r.next((e=>Gr.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?Gr.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,xa()))).next((t=>({batchId:o,changes:_a(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Ur(e)).next((t=>{let e=Ca();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const s=e.collectionGroup;let i=Ca();return this.indexManager.getCollectionParents(t,s).next((r=>Gr.forEach(r,(r=>{const o=function(t,e){return new ua(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(s));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{i=i.insert(t,e)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(t,e,n){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,s)))).next((t=>{s.forEach(((e,n)=>{const s=n.getKey();null===t.get(s)&&(t=t.insert(s,Po.newInvalidDocument(s)))}));let n=Ca();return t.forEach(((t,i)=>{const r=s.get(t);void 0!==r&&ec(r.mutation,i,oo.empty(),Rr.now()),va(e,i)&&(n=n.insert(t,i))})),n}))}}class bu{constructor(t){this.serializer=t,this.cs=new Map,this.hs=new Map}getBundleMetadata(t,e){return Gr.resolve(this.cs.get(e))}saveBundleMetadata(t,e){var n;return this.cs.set(e.id,{id:(n=e).id,version:n.version,createTime:qc(n.createTime)}),Gr.resolve()}getNamedQuery(t,e){return Gr.resolve(this.hs.get(e))}saveNamedQuery(t,e){return this.hs.set(e.name,function(t){return{name:t.name,query:hu(t.bundledQuery),readTime:qc(t.readTime)}}(e)),Gr.resolve()}}class Eu{constructor(){this.overlays=new eo(Ur.comparator),this.ls=new Map}getOverlay(t,e){return Gr.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Aa();return Gr.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,s)=>{this.we(t,e,s)})),Gr.resolve()}removeOverlaysForBatchId(t,e,n){const s=this.ls.get(n);return void 0!==s&&(s.forEach((t=>this.overlays=this.overlays.remove(t))),this.ls.delete(n)),Gr.resolve()}getOverlaysForCollection(t,e,n){const s=Aa(),i=e.length+1,r=new Ur(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===i&&t.largestBatchId>n&&s.set(t.getKey(),t)}return Gr.resolve(s)}getOverlaysForCollectionGroup(t,e,n,s){let i=new eo(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=Aa(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Aa(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=s)););return Gr.resolve(o)}we(t,e,n){const s=this.overlays.get(n.key);if(null!==s){const t=this.ls.get(s.largestBatchId).delete(n.key);this.ls.set(s.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new fc(e,n));let i=this.ls.get(e);void 0===i&&(i=xa(),this.ls.set(e,i)),this.ls.set(e,i.add(n.key))}}class Tu{constructor(){this.fs=new io(Iu.ds),this.ws=new io(Iu._s)}isEmpty(){return this.fs.isEmpty()}addReference(t,e){const n=new Iu(t,e);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.ys(new Iu(t,e))}ps(t,e){t.forEach((t=>this.removeReference(t,e)))}Is(t){const e=new Ur(new Fr([])),n=new Iu(e,t),s=new Iu(e,t+1),i=[];return this.ws.forEachInRange([n,s],(t=>{this.ys(t),i.push(t.key)})),i}Ts(){this.fs.forEach((t=>this.ys(t)))}ys(t){this.fs=this.fs.delete(t),this.ws=this.ws.delete(t)}Es(t){const e=new Ur(new Fr([])),n=new Iu(e,t),s=new Iu(e,t+1);let i=xa();return this.ws.forEachInRange([n,s],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new Iu(t,0),n=this.fs.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Iu{constructor(t,e){this.key=t,this.As=e}static ds(t,e){return Ur.comparator(t.key,e.key)||xr(t.As,e.As)}static _s(t,e){return xr(t.As,e.As)||Ur.comparator(t.key,e.key)}}class Su{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.vs=1,this.Rs=new io(Iu.ds)}checkEmpty(t){return Gr.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,s){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new hc(i,e,n,s);this.mutationQueue.push(r);for(const e of s)this.Rs=this.Rs.add(new Iu(e.key,i)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Gr.resolve(r)}lookupMutationBatch(t,e){return Gr.resolve(this.Ps(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,s=this.bs(n),i=s<0?0:s;return Gr.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Gr.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(t){return Gr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Iu(e,0),s=new Iu(e,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,s],(t=>{const e=this.Ps(t.As);i.push(e)})),Gr.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new io(xr);return e.forEach((t=>{const e=new Iu(t,0),s=new Iu(t,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([e,s],(t=>{n=n.add(t.As)}))})),Gr.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,s=n.length+1;let i=n;Ur.isDocumentKey(i)||(i=i.child(""));const r=new Iu(new Ur(i),0);let o=new io(xr);return this.Rs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===s&&(o=o.add(t.As)),!0)}),r),Gr.resolve(this.Vs(o))}Vs(t){const e=[];return t.forEach((t=>{const n=this.Ps(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){yr(0===this.Ss(e.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return Gr.forEach(e.mutations,(s=>{const i=new Iu(s.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Rs=n}))}Cn(t){}containsKey(t,e){const n=new Iu(e,0),s=this.Rs.firstAfterOrEqual(n);return Gr.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,Gr.resolve()}Ss(t,e){return this.bs(t)}bs(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Ps(t){const e=this.bs(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Cu{constructor(t){this.Ds=t,this.docs=new eo(Ur.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,s=this.docs.get(n),i=s?s.size:0,r=this.Ds(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Gr.resolve(n?n.document.mutableCopy():Po.newInvalidDocument(e))}getEntries(t,e){let n=Ia();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Po.newInvalidDocument(t))})),Gr.resolve(n)}getDocumentsMatchingQuery(t,e,n,s){let i=Ia();const r=e.path,o=new Ur(r.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!r.isPrefixOf(t.path))break;t.path.length>r.length+1||$r(jr(o),n)<=0||(s.has(o.key)||va(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Gr.resolve(i)}getAllFromCollectionGroup(t,e,n,s){mr()}Cs(t,e){return Gr.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new _u(this)}getSize(t){return Gr.resolve(this.size)}}class _u extends yu{constructor(t){super(),this.os=t}applyChanges(t){const e=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?e.push(this.os.addEntry(t,s)):this.os.removeEntry(n)})),Gr.waitFor(e)}getFromCache(t,e){return this.os.getEntry(t,e)}getAllFromCache(t,e){return this.os.getEntries(t,e)}}class Au{constructor(t){this.persistence=t,this.xs=new Ea((t=>oa(t)),aa),this.lastRemoteSnapshotVersion=Mr.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Tu,this.targetCount=0,this.Ms=mu.kn()}forEachTarget(t,e){return this.xs.forEach(((t,n)=>e(n))),Gr.resolve()}getLastRemoteSnapshotVersion(t){return Gr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Gr.resolve(this.Ns)}allocateTargetId(t){return this.highestTargetId=this.Ms.next(),Gr.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ns&&(this.Ns=e),Gr.resolve()}Fn(t){this.xs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ms=new mu(e),this.highestTargetId=e),t.sequenceNumber>this.Ns&&(this.Ns=t.sequenceNumber)}addTargetData(t,e){return this.Fn(e),this.targetCount+=1,Gr.resolve()}updateTargetData(t,e){return this.Fn(e),Gr.resolve()}removeTargetData(t,e){return this.xs.delete(e.target),this.ks.Is(e.targetId),this.targetCount-=1,Gr.resolve()}removeTargets(t,e,n){let s=0;const i=[];return this.xs.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.xs.delete(r),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)})),Gr.waitFor(i).next((()=>s))}getTargetCount(t){return Gr.resolve(this.targetCount)}getTargetData(t,e){const n=this.xs.get(e)||null;return Gr.resolve(n)}addMatchingKeys(t,e,n){return this.ks.gs(e,n),Gr.resolve()}removeMatchingKeys(t,e,n){this.ks.ps(e,n);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach((e=>{i.push(s.markPotentiallyOrphaned(t,e))})),Gr.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.ks.Is(e),Gr.resolve()}getMatchingKeysForTargetId(t,e){const n=this.ks.Es(e);return Gr.resolve(n)}containsKey(t,e){return Gr.resolve(this.ks.containsKey(e))}}class Du{constructor(t,e){this.$s={},this.overlays={},this.Os=new Wr(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=t(this),this.Bs=new Au(this),this.indexManager=new fu,this.remoteDocumentCache=function(t){return new Cu(t)}((t=>this.referenceDelegate.Ls(t))),this.serializer=new lu(e),this.qs=new bu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Eu,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.$s[t.toKey()];return n||(n=new Su(e,this.referenceDelegate),this.$s[t.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(t,e,n){dr("MemoryPersistence","Starting transaction:",t);const s=new ku(this.Os.next());return this.referenceDelegate.Us(),n(s).next((t=>this.referenceDelegate.Ks(s).next((()=>t)))).toPromise().then((t=>(s.raiseOnCommittedEvent(),t)))}Gs(t,e){return Gr.or(Object.values(this.$s).map((n=>()=>n.containsKey(t,e))))}}class ku extends Kr{constructor(t){super(),this.currentSequenceNumber=t}}class Nu{constructor(t){this.persistence=t,this.Qs=new Tu,this.js=null}static zs(t){return new Nu(t)}get Ws(){if(this.js)return this.js;throw mr()}addReference(t,e,n){return this.Qs.addReference(n,e),this.Ws.delete(n.toString()),Gr.resolve()}removeReference(t,e,n){return this.Qs.removeReference(n,e),this.Ws.add(n.toString()),Gr.resolve()}markPotentiallyOrphaned(t,e){return this.Ws.add(e.toString()),Gr.resolve()}removeTarget(t,e){this.Qs.Is(e.targetId).forEach((t=>this.Ws.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ws.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Us(){this.js=new Set}Ks(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Gr.forEach(this.Ws,(n=>{const s=Ur.fromPath(n);return this.Hs(t,s).next((t=>{t||e.removeEntry(s,Mr.min())}))})).next((()=>(this.js=null,e.apply(t))))}updateLimboDocument(t,e){return this.Hs(t,e).next((t=>{t?this.Ws.delete(e.toString()):this.Ws.add(e.toString())}))}Ls(t){return 0}Hs(t,e){return Gr.or([()=>Gr.resolve(this.Qs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gs(t,e)])}}class Lu{constructor(t,e,n,s){this.targetId=t,this.fromCache=e,this.Fi=n,this.Bi=s}static Li(t,e){let n=xa(),s=xa();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:s=s.add(t.doc.key)}return new Lu(t,e.fromCache,n,s)}}class xu{constructor(){this.qi=!1}initialize(t,e){this.Ui=t,this.indexManager=e,this.qi=!0}getDocumentsMatchingQuery(t,e,n,s){return this.Ki(t,e).next((i=>i||this.Gi(t,e,s,n))).next((n=>n||this.Qi(t,e)))}Ki(t,e){if(ha(e))return Gr.resolve(null);let n=fa(e);return this.indexManager.getIndexType(t,n).next((s=>0===s?null:(null!==e.limit&&1===s&&(e=pa(e,null,"F"),n=fa(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((s=>{const i=xa(...s);return this.Ui.getDocuments(t,i).next((s=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.ji(e,s);return this.zi(e,r,i,n.readTime)?this.Ki(t,pa(e,null,"F")):this.Wi(t,r,e,n)}))))})))))}Gi(t,e,n,s){return ha(e)||s.isEqual(Mr.min())?this.Qi(t,e):this.Ui.getDocuments(t,n).next((i=>{const r=this.ji(e,i);return this.zi(e,r,n,s)?this.Qi(t,e):(hr()<=K.DEBUG&&dr("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ya(e)),this.Wi(t,r,e,function(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,i=Mr.fromTimestamp(1e9===s?new Rr(n+1,0):new Rr(n,s));return new qr(i,Ur.empty(),e)}(s,-1)))}))}ji(t,e){let n=new io(wa(t));return e.forEach(((e,s)=>{va(t,s)&&(n=n.add(s))})),n}zi(t,e,n,s){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Qi(t,e){return hr()<=K.DEBUG&&dr("QueryEngine","Using full collection scan to execute query:",ya(e)),this.Ui.getDocumentsMatchingQuery(t,e,qr.min())}Wi(t,e,n,s){return this.Ui.getDocumentsMatchingQuery(t,n,s).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Ou{constructor(t,e,n,s){this.persistence=t,this.Hi=e,this.serializer=s,this.Ji=new eo(xr),this.Yi=new Ea((t=>oa(t)),aa),this.Xi=new Map,this.Zi=t.getRemoteDocumentCache(),this.Bs=t.getTargetCache(),this.qs=t.getBundleCache(),this.tr(n)}tr(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new wu(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ji)))}}async function Ru(t,e){const n=vr(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let s;return n.mutationQueue.getAllMutationBatches(t).next((i=>(s=i,n.tr(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],r=[];let o=xa();for(const t of s){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({er:t,removedBatchIds:i,addedBatchIds:r})))}))}))}function Mu(t){const e=vr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Bs.getLastRemoteSnapshotVersion(t)))}function Pu(t,e){const n=vr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Fu(t,e,n){const s=vr(t),i=s.Ji.get(e),r=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",r,(t=>s.persistence.referenceDelegate.removeTarget(t,i)))}catch(t){if(!Qr(t))throw t;dr("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}s.Ji=s.Ji.remove(e),s.Yi.delete(i.target)}function Vu(t,e,n){const s=vr(t);let i=Mr.min(),r=xa();return s.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const s=vr(t),i=s.Yi.get(n);return void 0!==i?Gr.resolve(s.Ji.get(i)):s.Bs.getTargetData(e,n)}(s,t,fa(e)).next((e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,s.Bs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{r=t}))})).next((()=>s.Hi.getDocumentsMatchingQuery(t,e,n?i:Mr.min(),n?r:xa()))).next((t=>(function(t,e,n){let s=t.Xi.get(e)||Mr.min();n.forEach(((t,e)=>{e.readTime.compareTo(s)>0&&(s=e.readTime)})),t.Xi.set(e,s)}(s,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,ir:r})))))}class Bu{constructor(){this.activeTargetIds=Oa}lr(t){this.activeTargetIds=this.activeTargetIds.add(t)}dr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}hr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Uu{constructor(){this.Hr=new Bu,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Hr.lr(t),this.Jr[t]||"not-current"}updateQueryState(t,e,n){this.Jr[t]=e}removeLocalQueryTarget(t){this.Hr.dr(t)}isLocalQueryTarget(t){return this.Hr.activeTargetIds.has(t)}clearQueryState(t){delete this.Jr[t]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(t){return this.Hr.activeTargetIds.has(t)}start(){return this.Hr=new Bu,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class ju{Yr(t){}shutdown(){}}class qu{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(t){this.so.push(t)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.so)t(0)}no(){dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.so)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let $u=null;function zu(){return null===$u?$u=268435456+Math.round(2147483648*Math.random()):$u++,"0x"+$u.toString(16)}const Ku={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Hu{constructor(t){this.ro=t.ro,this.oo=t.oo}uo(t){this.co=t}ao(t){this.ho=t}onMessage(t){this.lo=t}close(){this.oo()}send(t){this.ro(t)}fo(){this.co()}wo(t){this.ho(t)}_o(t){this.lo(t)}}const Gu="WebChannelConnection";class Qu extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.mo=e+"://"+t.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(t,e,n,s,i){const r=zu(),o=this.To(t,e);dr("RestConnection",`Sending RPC '${t}' ${r}:`,o,n);const a={};return this.Eo(a,s,i),this.Ao(t,o,a,n).then((e=>(dr("RestConnection",`Received RPC '${t}' ${r}: `,e),e)),(e=>{throw pr("RestConnection",`RPC '${t}' ${r} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,s,i,r){return this.Io(t,e,n,s,i)}Eo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+ur,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}To(t,e){const n=Ku[t];return`${this.mo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Ao(t,e,n,s){const i=zu();return new Promise(((r,o)=>{const a=new ir;a.setWithCredentials(!0),a.listenOnce(Zi.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Ji.NO_ERROR:const e=a.getResponseJson();dr(Gu,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(e)),r(e);break;case Ji.TIMEOUT:dr(Gu,`RPC '${t}' ${i} timed out`),o(new br(wr.DEADLINE_EXCEEDED,"Request time out"));break;case Ji.HTTP_ERROR:const n=a.getStatus();if(dr(Gu,`RPC '${t}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(wr).indexOf(e)>=0?e:wr.UNKNOWN}(e.status);o(new br(t,e.message))}else o(new br(wr.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new br(wr.UNAVAILABLE,"Connection failed."));break;default:mr()}}finally{dr(Gu,`RPC '${t}' ${i} completed.`)}}));const c=JSON.stringify(s);dr(Gu,`RPC '${t}' ${i} sending request:`,s),a.send(e,"POST",c,n,15)}))}Ro(t,e,n){const s=zu(),i=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Xi(),o=Yi(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.xmlHttpFactory=new nr({})),this.Eo(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const u=i.join("");dr(Gu,`Creating RPC '${t}' stream ${s}: ${u}`,a);const l=r.createWebChannel(u,a);let h=!1,d=!1;const f=new Hu({ro:e=>{d?dr(Gu,`Not sending because RPC '${t}' stream ${s} is closed:`,e):(h||(dr(Gu,`Opening RPC '${t}' stream ${s} transport.`),l.open(),h=!0),dr(Gu,`RPC '${t}' stream ${s} sending:`,e),l.send(e))},oo:()=>l.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(l,sr.EventType.OPEN,(()=>{d||dr(Gu,`RPC '${t}' stream ${s} transport opened.`)})),p(l,sr.EventType.CLOSE,(()=>{d||(d=!0,dr(Gu,`RPC '${t}' stream ${s} transport closed`),f.wo())})),p(l,sr.EventType.ERROR,(e=>{d||(d=!0,pr(Gu,`RPC '${t}' stream ${s} transport errored:`,e),f.wo(new br(wr.UNAVAILABLE,"The operation could not be completed")))})),p(l,sr.EventType.MESSAGE,(e=>{var n;if(!d){const i=e.data[0];yr(!!i);const r=i,o=r.error||(null===(n=r[0])||void 0===n?void 0:n.error);if(o){dr(Gu,`RPC '${t}' stream ${s} received error:`,o);const e=o.status;let n=function(t){const e=gc[t];if(void 0!==e)return yc(e)}(e),i=o.message;void 0===n&&(n=wr.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),d=!0,f.wo(new br(n,i)),l.close()}else dr(Gu,`RPC '${t}' stream ${s} received:`,i),f._o(i)}})),p(o,tr.STAT_EVENT,(e=>{e.stat===er.PROXY?dr(Gu,`RPC '${t}' stream ${s} detected buffering proxy`):e.stat===er.NOPROXY&&dr(Gu,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{f.fo()}),0),f}}function Wu(){return"undefined"!=typeof document?document:null}function Xu(t){return new Fc(t,!0)}class Yu{constructor(t,e,n=1e3,s=1.5,i=6e4){this.ii=t,this.timerId=e,this.Po=n,this.bo=s,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(t){this.cancel();const e=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),s=Math.max(0,e-n);s>0&&dr("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.So} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,s,(()=>(this.Co=Date.now(),t()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Ju{constructor(t,e,n,s,i,r,o,a){this.ii=t,this.$o=n,this.Oo=s,this.connection=i,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Yu(t,e)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(t){this.Ho(),this.stream.send(t)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(t,e){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==t?this.qo.reset():e&&e.code===wr.RESOURCE_EXHAUSTED?(fr(e.toString()),fr("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):e&&e.code===wr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.ao(e)}Yo(){}auth(){this.state=1;const t=this.Xo(this.Fo),e=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Fo===e&&this.Zo(t,n)}),(e=>{t((()=>{const t=new br(wr.UNKNOWN,"Fetching auth token failed: "+e.message);return this.tu(t)}))}))}Zo(t,e){const n=this.Xo(this.Fo);this.stream=this.eu(t,e),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((t=>{n((()=>this.tu(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(t){return dr("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Xo(t){return e=>{this.ii.enqueueAndForget((()=>this.Fo===t?e():(dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Zu extends Ju{constructor(t,e,n,s,i,r){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,s,r),this.serializer=i}eu(t,e){return this.connection.Ro("Listen",t,e)}onMessage(t){this.qo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:mr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(t,e){return t.useProto3Json?(yr(void 0===e||"string"==typeof e),co.fromBase64String(e||"")):(yr(void 0===e||e instanceof Uint8Array),co.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?wr.UNKNOWN:yc(t.code);return new br(e,t.message||"")}(o);n=new kc(s,i,r,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=Hc(t,s.document.name),r=qc(s.document.updateTime),o=s.document.createTime?qc(s.document.createTime):Mr.min(),a=new Ro({mapValue:{fields:s.document.fields}}),c=Po.newFoundDocument(i,r,o,a),u=s.targetIds||[],l=s.removedTargetIds||[];n=new Ac(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=Hc(t,s.document),r=s.readTime?qc(s.readTime):Mr.min(),o=Po.newNoDocument(i,r),a=s.removedTargetIds||[];n=new Ac([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=Hc(t,s.document),r=s.removedTargetIds||[];n=new Ac([],r,i,null)}else{if(!("filter"in e))return mr();{e.filter;const t=e.filter;t.targetId;const{count:s=0,unchangedNames:i}=t,r=new pc(s,i),o=t.targetId;n=new Dc(o,r)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Mr.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Mr.min():e.readTime?qc(e.readTime):Mr.min()}(t);return this.listener.nu(e,n)}su(t){const e={};e.database=Qc(this.serializer),e.addTarget=function(t,e){let n;const s=e.target;if(n=ca(s)?{documents:Yc(t,s)}:{query:Jc(t,s)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Uc(t,e.resumeToken);const s=Vc(t,e.expectedCount);null!==s&&(n.expectedCount=s)}else if(e.snapshotVersion.compareTo(Mr.min())>0){n.readTime=Bc(t,e.snapshotVersion.toTimestamp());const s=Vc(t,e.expectedCount);null!==s&&(n.expectedCount=s)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mr()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.Wo(e)}iu(t){const e={};e.database=Qc(this.serializer),e.removeTarget=t,this.Wo(e)}}class tl extends Ju{constructor(t,e,n,s,i,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,s,r),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(t,e){return this.connection.Ro("Write",t,e)}onMessage(t){if(yr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.qo.reset();const e=function(t,e){return t&&t.length>0?(yr(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?qc(t.updateTime):qc(e);return n.isEqual(Mr.min())&&(n=qc(e)),new Wa(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=qc(t.commitTime);return this.listener.cu(n,e)}return yr(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.au()}hu(){const t={};t.database=Qc(this.serializer),this.Wo(t)}uu(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof ic)n={update:Xc(t,e.key,e.value)};else if(e instanceof uc)n={delete:Kc(t,e.key)};else if(e instanceof rc)n={update:Xc(t,e.key,e.data),updateMask:au(e.fieldMask)};else{if(!(e instanceof lc))return mr();n={verify:Kc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof ja)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof qa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof za)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ha)return{fieldPath:e.field.canonicalString(),increment:n.gt};throw mr()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:jc(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:mr()}(t,e.precondition)),n}(this.serializer,t)))};this.Wo(e)}}class el extends class{}{constructor(t,e,n,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=s,this.lu=!1}fu(){if(this.lu)throw new br(wr.FAILED_PRECONDITION,"The client has already been terminated.")}Io(t,e,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,i])=>this.connection.Io(t,e,n,s,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===wr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new br(wr.UNKNOWN,t.toString())}))}vo(t,e,n,s){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.vo(t,e,n,i,r,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===wr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new br(wr.UNKNOWN,t.toString())}))}terminate(){this.lu=!0}}class nl{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(t){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.yu("Offline")))}set(t){this.Tu(),this.wu=0,"Online"===t&&(this.mu=!1),this.yu(t)}yu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}pu(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(fr(e),this.mu=!1):dr("OnlineStateTracker",e)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class sl{constructor(t,e,n,s,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr((t=>{n.enqueueAndForget((async()=>{dl(this)&&(dr("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=vr(t);e.vu.add(4),await rl(e),e.bu.set("Unknown"),e.vu.delete(4),await il(e)}(this))}))})),this.bu=new nl(n,s)}}async function il(t){if(dl(t))for(const e of t.Ru)await e(!0)}async function rl(t){for(const e of t.Ru)await e(!1)}function ol(t,e){const n=vr(t);n.Au.has(e.targetId)||(n.Au.set(e.targetId,e),hl(n)?ll(n):kl(n).Ko()&&cl(n,e))}function al(t,e){const n=vr(t),s=kl(n);n.Au.delete(e),s.Ko()&&ul(n,e),0===n.Au.size&&(s.Ko()?s.jo():dl(n)&&n.bu.set("Unknown"))}function cl(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Mr.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}kl(t).su(e)}function ul(t,e){t.Vu.qt(e),kl(t).iu(e)}function ll(t){t.Vu=new Lc({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),kl(t).start(),t.bu.gu()}function hl(t){return dl(t)&&!kl(t).Uo()&&t.Au.size>0}function dl(t){return 0===vr(t).vu.size}function fl(t){t.Vu=void 0}async function pl(t){t.Au.forEach(((e,n)=>{cl(t,e)}))}async function gl(t,e){fl(t),hl(t)?(t.bu.Iu(e),ll(t)):t.bu.set("Unknown")}async function ml(t,e,n){if(t.bu.set("Online"),e instanceof kc&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const s of e.targetIds)t.Au.has(s)&&(await t.remoteSyncer.rejectListen(s,n),t.Au.delete(s),t.Vu.removeTarget(s))}(t,e)}catch(n){dr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await yl(t,n)}else if(e instanceof Ac?t.Vu.Ht(e):e instanceof Dc?t.Vu.ne(e):t.Vu.Xt(e),!n.isEqual(Mr.min()))try{const e=await Mu(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.Vu.ce(e);return n.targetChanges.forEach(((n,s)=>{if(n.resumeToken.approximateByteSize()>0){const i=t.Au.get(s);i&&t.Au.set(s,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const s=t.Au.get(e);if(!s)return;t.Au.set(e,s.withResumeToken(co.EMPTY_BYTE_STRING,s.snapshotVersion)),ul(t,e);const i=new uu(s.target,e,n,s.sequenceNumber);cl(t,i)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){dr("RemoteStore","Failed to raise snapshot:",e),await yl(t,e)}}async function yl(t,e,n){if(!Qr(e))throw e;t.vu.add(1),await rl(t),t.bu.set("Offline"),n||(n=()=>Mu(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{dr("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await il(t)}))}function vl(t,e){return e().catch((n=>yl(t,n,e)))}async function wl(t){const e=vr(t),n=Nl(e);let s=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;bl(e);)try{const t=await Pu(e.localStore,s);if(null===t){0===e.Eu.length&&n.jo();break}s=t.batchId,El(e,t)}catch(t){await yl(e,t)}Tl(e)&&Il(e)}function bl(t){return dl(t)&&t.Eu.length<10}function El(t,e){t.Eu.push(e);const n=Nl(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function Tl(t){return dl(t)&&!Nl(t).Uo()&&t.Eu.length>0}function Il(t){Nl(t).start()}async function Sl(t){Nl(t).hu()}async function Cl(t){const e=Nl(t);for(const n of t.Eu)e.uu(n.mutations)}async function _l(t,e,n){const s=t.Eu.shift(),i=dc.from(s,e,n);await vl(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await wl(t)}async function Al(t,e){e&&Nl(t).ou&&await async function(t,e){if(function(t){switch(t){default:return mr();case wr.CANCELLED:case wr.UNKNOWN:case wr.DEADLINE_EXCEEDED:case wr.RESOURCE_EXHAUSTED:case wr.INTERNAL:case wr.UNAVAILABLE:case wr.UNAUTHENTICATED:return!1;case wr.INVALID_ARGUMENT:case wr.NOT_FOUND:case wr.ALREADY_EXISTS:case wr.PERMISSION_DENIED:case wr.FAILED_PRECONDITION:case wr.ABORTED:case wr.OUT_OF_RANGE:case wr.UNIMPLEMENTED:case wr.DATA_LOSS:return!0}}(n=e.code)&&n!==wr.ABORTED){const n=t.Eu.shift();Nl(t).Qo(),await vl(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await wl(t)}var n}(t,e),Tl(t)&&Il(t)}async function Dl(t,e){const n=vr(t);n.asyncQueue.verifyOperationInProgress(),dr("RemoteStore","RemoteStore received new credentials");const s=dl(n);n.vu.add(3),await rl(n),s&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await il(n)}function kl(t){return t.Su||(t.Su=function(t,e,n){const s=vr(t);return s.fu(),new Zu(e,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(t.datastore,t.asyncQueue,{uo:pl.bind(null,t),ao:gl.bind(null,t),nu:ml.bind(null,t)}),t.Ru.push((async e=>{e?(t.Su.Qo(),hl(t)?ll(t):t.bu.set("Unknown")):(await t.Su.stop(),fl(t))}))),t.Su}function Nl(t){return t.Du||(t.Du=function(t,e,n){const s=vr(t);return s.fu(),new tl(e,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(t.datastore,t.asyncQueue,{uo:Sl.bind(null,t),ao:Al.bind(null,t),au:Cl.bind(null,t),cu:_l.bind(null,t)}),t.Ru.push((async e=>{e?(t.Du.Qo(),await wl(t)):(await t.Du.stop(),t.Eu.length>0&&(dr("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))}))),t.Du}class Ll{constructor(t,e,n,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,s,i){const r=Date.now()+n,o=new Ll(t,e,r,s,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new br(wr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xl(t,e){if(fr("AsyncQueue",`${e}: ${t}`),Qr(t))return new br(wr.UNAVAILABLE,`${e}: ${t}`);throw t}class Ol{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Ur.comparator(e.key,n.key):(t,e)=>Ur.comparator(t.key,e.key),this.keyedMap=Ca(),this.sortedSet=new eo(this.comparator)}static emptySet(t){return new Ol(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Ol))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(!t.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Ol;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Rl{constructor(){this.Cu=new eo(Ur.comparator)}track(t){const e=t.doc.key,n=this.Cu.get(e);n?0!==t.type&&3===n.type?this.Cu=this.Cu.insert(e,t):3===t.type&&1!==n.type?this.Cu=this.Cu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Cu=this.Cu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Cu=this.Cu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Cu=this.Cu.remove(e):1===t.type&&2===n.type?this.Cu=this.Cu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Cu=this.Cu.insert(e,{type:2,doc:t.doc}):mr():this.Cu=this.Cu.insert(e,t)}xu(){const t=[];return this.Cu.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Ml{constructor(t,e,n,s,i,r,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,s,i){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new Ml(t,e,Ol.emptySet(e),r,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ga(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Pl{constructor(){this.Nu=void 0,this.listeners=[]}}class Fl{constructor(){this.queries=new Ea((t=>ma(t)),ga),this.onlineState="Unknown",this.ku=new Set}}function Vl(t,e){const n=vr(t);let s=!1;for(const t of e){const e=t.query,i=n.queries.get(e);if(i){for(const e of i.listeners)e.$u(t)&&(s=!0);i.Nu=t}}s&&Ul(n)}function Bl(t,e,n){const s=vr(t),i=s.queries.get(e);if(i)for(const t of i.listeners)t.onError(n);s.queries.delete(e)}function Ul(t){t.ku.forEach((t=>{t.next()}))}class jl{constructor(t,e,n){this.query=t,this.Ou=e,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Ml(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Fu?this.Lu(t)&&(this.Ou.next(t),e=!0):this.qu(t,this.onlineState)&&(this.Uu(t),e=!0),this.Bu=t,e}onError(t){this.Ou.error(t)}Mu(t){this.onlineState=t;let e=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,t)&&(this.Uu(this.Bu),e=!0),e}qu(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Ku||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Lu(t){if(t.docChanges.length>0)return!0;const e=this.Bu&&this.Bu.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Uu(t){t=Ml.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Fu=!0,this.Ou.next(t)}}class ql{constructor(t){this.key=t}}class $l{constructor(t){this.key=t}}class zl{constructor(t,e){this.query=t,this.Yu=e,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=xa(),this.mutatedKeys=xa(),this.tc=wa(t),this.ec=new Ol(this.tc)}get nc(){return this.Yu}sc(t,e){const n=e?e.ic:new Rl,s=e?e.ec:this.ec;let i=e?e.mutatedKeys:this.mutatedKeys,r=s,o=!1;const a="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,c="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((t,e)=>{const u=s.get(t),l=va(this.query,e)?e:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.rc(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.tc(l,a)>0||c&&this.tc(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(r=r.add(l),i=d?i.add(t):i.delete(t)):(r=r.delete(t),i=i.delete(t)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const t="F"===this.query.limitType?r.last():r.first();r=r.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{ec:r,ic:n,zi:o,mutatedKeys:i}}rc(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const s=this.ec;this.ec=t.ec,this.mutatedKeys=t.mutatedKeys;const i=t.ic.xu();i.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mr()}};return n(t)-n(e)}(t.type,e.type)||this.tc(t.doc,e.doc))),this.oc(n);const r=e?this.uc():[],o=0===this.Zu.size&&this.current?1:0,a=o!==this.Xu;return this.Xu=o,0!==i.length||a?{snapshot:new Ml(this.query,t.ec,s,i,t.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:r}:{cc:r}}Mu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Rl,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(t){return!this.Yu.has(t)&&!!this.ec.has(t)&&!this.ec.get(t).hasLocalMutations}oc(t){t&&(t.addedDocuments.forEach((t=>this.Yu=this.Yu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Yu=this.Yu.delete(t))),this.current=t.current)}uc(){if(!this.current)return[];const t=this.Zu;this.Zu=xa(),this.ec.forEach((t=>{this.ac(t.key)&&(this.Zu=this.Zu.add(t.key))}));const e=[];return t.forEach((t=>{this.Zu.has(t)||e.push(new $l(t))})),this.Zu.forEach((n=>{t.has(n)||e.push(new ql(n))})),e}hc(t){this.Yu=t.ir,this.Zu=xa();const e=this.sc(t.documents);return this.applyChanges(e,!0)}lc(){return Ml.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Kl{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Hl{constructor(t){this.key=t,this.fc=!1}}class Gl{constructor(t,e,n,s,i,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=r,this.dc={},this.wc=new Ea((t=>ma(t)),ga),this._c=new Map,this.mc=new Set,this.gc=new eo(Ur.comparator),this.yc=new Map,this.Ic=new Tu,this.Tc={},this.Ec=new Map,this.Ac=mu.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function Ql(t,e){const n=function(t){const e=vr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lh.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Jl.bind(null,e),e.dc.nu=Vl.bind(null,e.eventManager),e.dc.Pc=Bl.bind(null,e.eventManager),e}(t);let s,i;const r=n.wc.get(e);if(r)s=r.targetId,n.sharedClientState.addLocalQueryTarget(s),i=r.view.lc();else{const t=await function(t,e){const n=vr(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let s;return n.Bs.getTargetData(t,e).next((i=>i?(s=i,Gr.resolve(s)):n.Bs.allocateTargetId(t).next((i=>(s=new uu(e,i,"TargetPurposeListen",t.currentSequenceNumber),n.Bs.addTargetData(t,s).next((()=>s)))))))})).then((t=>{const s=n.Ji.get(t.targetId);return(null===s||t.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(t.targetId,t),n.Yi.set(e,t.targetId)),t}))}(n.localStore,fa(e)),r=n.sharedClientState.addLocalQueryTarget(t.targetId);s=t.targetId,i=await async function(t,e,n,s,i){t.Rc=(e,n,s)=>async function(t,e,n,s){let i=e.view.sc(n);i.zi&&(i=await Vu(t.localStore,e.query,!1).then((({documents:t})=>e.view.sc(t,i))));const r=s&&s.targetChanges.get(e.targetId),o=e.view.applyChanges(i,t.isPrimaryClient,r);return rh(t,e.targetId,o.cc),o.snapshot}(t,e,n,s);const r=await Vu(t.localStore,e,!0),o=new zl(e,r.ir),a=o.sc(r.documents),c=_c.createSynthesizedTargetChangeForCurrentChange(n,s&&"Offline"!==t.onlineState,i),u=o.applyChanges(a,t.isPrimaryClient,c);rh(t,n,u.cc);const l=new Kl(e,n,o);return t.wc.set(e,l),t._c.has(n)?t._c.get(n).push(e):t._c.set(n,[e]),u.snapshot}(n,e,s,"current"===r,t.resumeToken),n.isPrimaryClient&&ol(n.remoteStore,t)}return i}async function Wl(t,e){const n=vr(t),s=n.wc.get(e),i=n._c.get(s.targetId);if(i.length>1)return n._c.set(s.targetId,i.filter((t=>!ga(t,e)))),void n.wc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Fu(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),al(n.remoteStore,s.targetId),sh(n,s.targetId)})).catch(Hr)):(sh(n,s.targetId),await Fu(n.localStore,s.targetId,!0))}async function Xl(t,e){const n=vr(t);try{const t=await function(t,e){const n=vr(t),s=e.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const r=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const o=[];e.targetChanges.forEach(((r,a)=>{const c=i.get(a);if(!c)return;o.push(n.Bs.removeMatchingKeys(t,r.removedDocuments,a).next((()=>n.Bs.addMatchingKeys(t,r.addedDocuments,a))));let u=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?u=u.withResumeToken(co.EMPTY_BYTE_STRING,Mr.min()).withLastLimboFreeSnapshotVersion(Mr.min()):r.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(r.resumeToken,s)),i=i.insert(a,u),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,r)&&o.push(n.Bs.updateTargetData(t,u))}));let a=Ia(),c=xa();if(e.documentUpdates.forEach((s=>{e.resolvedLimboDocuments.has(s)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,s))})),o.push(function(t,e,n){let s=xa(),i=xa();return n.forEach((t=>s=s.add(t))),e.getEntries(t,s).next((t=>{let s=Ia();return n.forEach(((n,r)=>{const o=t.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),r.isNoDocument()&&r.version.isEqual(Mr.min())?(e.removeEntry(n,r.readTime),s=s.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(r),s=s.insert(n,r)):dr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{nr:s,sr:i}}))}(t,r,e.documentUpdates).next((t=>{a=t.nr,c=t.sr}))),!s.isEqual(Mr.min())){const e=n.Bs.getLastRemoteSnapshotVersion(t).next((e=>n.Bs.setTargetsMetadata(t,t.currentSequenceNumber,s)));o.push(e)}return Gr.waitFor(o).next((()=>r.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.Ji=i,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const s=n.yc.get(e);s&&(yr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?s.fc=!0:t.modifiedDocuments.size>0?yr(s.fc):t.removedDocuments.size>0&&(yr(s.fc),s.fc=!1))})),await ch(n,t,e)}catch(t){await Hr(t)}}function Yl(t,e,n){const s=vr(t);if(s.isPrimaryClient&&0===n||!s.isPrimaryClient&&1===n){const t=[];s.wc.forEach(((n,s)=>{const i=s.view.Mu(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=vr(t);n.onlineState=e;let s=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.Mu(e)&&(s=!0)})),s&&Ul(n)}(s.eventManager,e),t.length&&s.dc.nu(t),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function Jl(t,e,n){const s=vr(t);s.sharedClientState.updateQueryState(e,"rejected",n);const i=s.yc.get(e),r=i&&i.key;if(r){let t=new eo(Ur.comparator);t=t.insert(r,Po.newNoDocument(r,Mr.min()));const n=xa().add(r),i=new Cc(Mr.min(),new Map,new eo(xr),t,n);await Xl(s,i),s.gc=s.gc.remove(r),s.yc.delete(e),ah(s)}else await Fu(s.localStore,e,!1).then((()=>sh(s,e,n))).catch(Hr)}async function Zl(t,e){const n=vr(t),s=e.batch.batchId;try{const t=await function(t,e){const n=vr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const s=e.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,s){const i=n.batch,r=i.keys();let o=Gr.resolve();return r.forEach((t=>{o=o.next((()=>s.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);yr(null!==r),e.version.compareTo(r)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),s.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(n,t,e,i).next((()=>i.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,s,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=xa();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,s)))}))}(n.localStore,e);nh(n,s,null),eh(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await ch(n,t)}catch(t){await Hr(t)}}async function th(t,e,n){const s=vr(t);try{const t=await function(t,e){const n=vr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let s;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(yr(null!==e),s=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,s,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,s))).next((()=>n.localDocuments.getDocuments(t,s)))}))}(s.localStore,e);nh(s,e,n),eh(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await ch(s,t)}catch(n){await Hr(n)}}function eh(t,e){(t.Ec.get(e)||[]).forEach((t=>{t.resolve()})),t.Ec.delete(e)}function nh(t,e,n){const s=vr(t);let i=s.Tc[s.currentUser.toKey()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),s.Tc[s.currentUser.toKey()]=i}}function sh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t._c.get(e))t.wc.delete(s),n&&t.dc.Pc(s,n);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach((e=>{t.Ic.containsKey(e)||ih(t,e)}))}function ih(t,e){t.mc.delete(e.path.canonicalString());const n=t.gc.get(e);null!==n&&(al(t.remoteStore,n),t.gc=t.gc.remove(e),t.yc.delete(n),ah(t))}function rh(t,e,n){for(const s of n)s instanceof ql?(t.Ic.addReference(s.key,e),oh(t,s)):s instanceof $l?(dr("SyncEngine","Document no longer in limbo: "+s.key),t.Ic.removeReference(s.key,e),t.Ic.containsKey(s.key)||ih(t,s.key)):mr()}function oh(t,e){const n=e.key,s=n.path.canonicalString();t.gc.get(n)||t.mc.has(s)||(dr("SyncEngine","New document in limbo: "+n),t.mc.add(s),ah(t))}function ah(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const n=new Ur(Fr.fromString(e)),s=t.Ac.next();t.yc.set(s,new Hl(n)),t.gc=t.gc.insert(n,s),ol(t.remoteStore,new uu(fa(la(n.path)),s,"TargetPurposeLimboResolution",Wr.ct))}}async function ch(t,e,n){const s=vr(t),i=[],r=[],o=[];s.wc.isEmpty()||(s.wc.forEach(((t,a)=>{o.push(s.Rc(a,e,n).then((t=>{if((t||n)&&s.isPrimaryClient&&s.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=Lu.Li(a.targetId,t);r.push(e)}})))})),await Promise.all(o),s.dc.nu(i),await async function(t,e){const n=vr(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Gr.forEach(e,(e=>Gr.forEach(e.Fi,(s=>n.persistence.referenceDelegate.addReference(t,e.targetId,s))).next((()=>Gr.forEach(e.Bi,(s=>n.persistence.referenceDelegate.removeReference(t,e.targetId,s)))))))))}catch(t){if(!Qr(t))throw t;dr("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ji.get(e),s=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(s);n.Ji=n.Ji.insert(e,i)}}}(s.localStore,r))}async function uh(t,e){const n=vr(t);if(!n.currentUser.isEqual(e)){dr("SyncEngine","User change. New user:",e.toKey());const t=await Ru(n.localStore,e);n.currentUser=e,function(t,e){t.Ec.forEach((t=>{t.forEach((t=>{t.reject(new br(wr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ec.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await ch(n,t.er)}}function lh(t,e){const n=vr(t),s=n.yc.get(e);if(s&&s.fc)return xa().add(s.key);{let t=xa();const s=n._c.get(e);if(!s)return t;for(const e of s){const s=n.wc.get(e);t=t.unionWith(s.view.nc)}return t}}function hh(t){const e=vr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Zl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=th.bind(null,e),e}class dh{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Xu(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,s){return new Ou(t,e,n,s)}(this.persistence,new xu,t.initialUser,this.serializer)}createPersistence(t){return new Du(Nu.zs,this.serializer)}createSharedClientState(t){return new Uu}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class fh{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Yl(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=uh.bind(null,this.syncEngine),await async function(t,e){const n=vr(t);e?(n.vu.delete(2),await il(n)):e||(n.vu.add(2),await rl(n),n.bu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Fl}createDatastore(t){const e=Xu(t.databaseInfo.databaseId),n=(s=t.databaseInfo,new Qu(s));var s;return function(t,e,n,s){return new el(t,e,n,s)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,s=t.asyncQueue,i=t=>Yl(this.syncEngine,t,0),r=qu.D()?new qu:new ju,new sl(e,n,s,i,r);var e,n,s,i,r}createSyncEngine(t,e){return function(t,e,n,s,i,r,o){const a=new Gl(t,e,n,s,i,r);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=vr(t);dr("RemoteStore","RemoteStore shutting down."),e.vu.add(5),await rl(e),e.Pu.shutdown(),e.bu.set("Unknown")}(this.remoteStore)}}class ph{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Sc(this.observer.next,t)}error(t){this.observer.error?this.Sc(this.observer.error,t):fr("Uncaught Error in snapshot listener:",t.toString())}Dc(){this.muted=!0}Sc(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class gh{constructor(t,e,n,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=cr.UNAUTHENTICATED,this.clientId=Lr.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{dr("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(dr("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new br(wr.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=xl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function mh(t,e){t.asyncQueue.verifyOperationInProgress(),dr("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener((async t=>{s.isEqual(t)||(await Ru(e.localStore,t),s=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function yh(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){dr("FirestoreClient","Using user provided OfflineComponentProvider");try{await mh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===wr.FAILED_PRECONDITION||t.code===wr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;pr("Error using user provided cache. Falling back to memory cache: "+n),await mh(t,new dh)}}else dr("FirestoreClient","Using default OfflineComponentProvider"),await mh(t,new dh);return t._offlineComponents}(t);dr("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener((t=>Dl(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Dl(e.remoteStore,n))),t._onlineComponents=e}async function vh(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(dr("FirestoreClient","Using user provided OnlineComponentProvider"),await yh(t,t._uninitializedComponentsProvider._online)):(dr("FirestoreClient","Using default OnlineComponentProvider"),await yh(t,new fh))),t._onlineComponents}async function wh(t){const e=await vh(t),n=e.eventManager;return n.onListen=Ql.bind(null,e.syncEngine),n.onUnlisten=Wl.bind(null,e.syncEngine),n}function bh(t,e,n={}){const s=new Er;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,s,i){const r=new ph({next:n=>{e.enqueueAndForget((()=>async function(t,e){const n=vr(t),s=e.query;let i=!1;const r=n.queries.get(s);if(r){const t=r.listeners.indexOf(e);t>=0&&(r.listeners.splice(t,1),i=0===r.listeners.length)}if(i)return n.queries.delete(s),n.onUnlisten(s)}(t,o))),n.fromCache&&"server"===s.source?i.reject(new br(wr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:t=>i.reject(t)}),o=new jl(n,r,{includeMetadataChanges:!0,Ku:!0});return async function(t,e){const n=vr(t),s=e.query;let i=!1,r=n.queries.get(s);if(r||(i=!0,r=new Pl),i)try{r.Nu=await n.onListen(s)}catch(t){const n=xl(t,`Initialization of query '${ya(e.query)}' failed`);return void e.onError(n)}n.queries.set(s,r),r.listeners.push(e),e.Mu(n.onlineState),r.Nu&&e.$u(r.Nu)&&Ul(n)}(t,o)}(await wh(t),t.asyncQueue,e,n,s))),s.promise}function Eh(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Th=new Map;function Ih(t,e,n){if(!n)throw new br(wr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Sh(t){if(!Ur.isDocumentKey(t))throw new br(wr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ch(t){if(Ur.isDocumentKey(t))throw new br(wr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function _h(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":mr()}function Ah(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new br(wr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_h(t);throw new br(wr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Dh{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new br(wr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new br(wr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,s){if(!0===e&&!0===s)throw new br(wr.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Eh(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new br(wr.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new br(wr.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new br(wr.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(e=this.experimentalLongPollingOptions,n=t.experimentalLongPollingOptions,e.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams;var e,n}}class kh{constructor(t,e,n,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dh({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new br(wr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new br(wr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dh(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Ir;switch(t.type){case"firstParty":return new Ar(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new br(wr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Th.get(t);e&&(dr("ComponentProvider","Removing Datastore"),Th.delete(t),e.terminate())}(this),Promise.resolve()}}class Nh{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xh(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Nh(this.firestore,t,this._key)}}class Lh{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Lh(this.firestore,t,this._query)}}class xh extends Lh{constructor(t,e,n){super(t,e,la(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Nh(this.firestore,null,new Ur(t))}withConverter(t){return new xh(this.firestore,t,this._path)}}function Oh(t,e,...n){if(t=B(t),Ih("collection","path",e),t instanceof kh){const s=Fr.fromString(e,...n);return Ch(s),new xh(t,null,s)}{if(!(t instanceof Nh||t instanceof xh))throw new br(wr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Fr.fromString(e,...n));return Ch(s),new xh(t.firestore,null,s)}}class Rh{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Yu(this,"async_queue_retry"),this.Xc=()=>{const t=Wu();t&&dr("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const t=Wu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Zc(),this.ta(t)}enterRestrictedMode(t){if(!this.jc){this.jc=!0,this.Jc=t||!1;const e=Wu();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Xc)}}enqueue(t){if(this.Zc(),this.jc)return new Promise((()=>{}));const e=new Er;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Qc.push(t),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(t){if(!Qr(t))throw t;dr("AsyncQueue","Operation failed with retryable error: "+t)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(t){const e=this.Gc.then((()=>(this.Hc=!0,t().catch((t=>{this.Wc=t,this.Hc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw fr("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Hc=!1,t))))));return this.Gc=e,e}enqueueAfterDelay(t,e,n){this.Zc(),this.Yc.indexOf(t)>-1&&(e=0);const s=Ll.createAndSchedule(this,t,e,n,(t=>this.na(t)));return this.zc.push(s),s}Zc(){this.Wc&&mr()}verifyOperationInProgress(){}async sa(){let t;do{t=this.Gc,await t}while(t!==this.Gc)}ia(t){for(const e of this.zc)if(e.timerId===t)return!0;return!1}ra(t){return this.sa().then((()=>{this.zc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.zc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.sa()}))}oa(t){this.Yc.push(t)}na(t){const e=this.zc.indexOf(t);this.zc.splice(e,1)}}class Mh extends kh{constructor(t,e,n,s){super(t,e,n,s),this.type="firestore",this._queue=new Rh,this._persistenceKey=(null==s?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Fh(this),this._firestoreClient.terminate()}}function Ph(t){return t._firestoreClient||Fh(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Fh(t){var e,n,s;const i=t._freezeSettings(),r=function(t,e,n,s){return new yo(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,Eh(s.experimentalLongPollingOptions),s.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new gh(t._authCredentials,t._appCheckCredentials,t._queue,r),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(s=i.cache)||void 0===s?void 0:s._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class Vh{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Vh(co.fromBase64String(t))}catch(t){throw new br(wr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Vh(co.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Bh{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new br(wr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Br(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Uh{constructor(t){this._methodName=t}}class jh{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new br(wr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new br(wr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return xr(this._lat,t._lat)||xr(this._long,t._long)}}const qh=/^__.*__$/;class $h{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new rc(t,this.data,this.fieldMask,e,this.fieldTransforms):new ic(t,this.data,e,this.fieldTransforms)}}function zh(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mr()}}class Kh{constructor(t,e,n,s,i,r){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=s,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=r||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(t){return new Kh(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.aa({path:n,la:!1});return s.fa(t),s}da(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.aa({path:n,la:!1});return s.ua(),s}wa(t){return this.aa({path:void 0,la:!0})}_a(t){return nd(t,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}ua(){if(this.path)for(let t=0;t<this.path.length;t++)this.fa(this.path.get(t))}fa(t){if(0===t.length)throw this._a("Document fields must not be empty");if(zh(this.ca)&&qh.test(t))throw this._a('Document fields cannot begin and end with "__"')}}class Hh{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Xu(t)}ya(t,e,n,s=!1){return new Kh({ca:t,methodName:e,ga:n,path:Br.emptyPath(),la:!1,ma:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gh(t){const e=t._freezeSettings(),n=Xu(t._databaseId);return new Hh(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Qh(t,e,n,s,i,r={}){const o=t.ya(r.merge||r.mergeFields?2:0,e,n,i);Jh("Data must be an object, but it was:",o,s);const a=Xh(s,o);let c,u;if(r.merge)c=new oo(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const s of r.mergeFields){const i=Zh(e,s,n);if(!o.contains(i))throw new br(wr.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);sd(t,i)||t.push(i)}c=new oo(t),u=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,u=o.fieldTransforms;return new $h(new Ro(a),c,u)}function Wh(t,e){if(Yh(t=B(t)))return Jh("Unsupported field value:",e,t),Xh(t,e);if(t instanceof Uh)return function(t,e){if(!zh(e.ca))throw e._a(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e._a(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,e){const n=[];let s=0;for(const i of t){let t=Wh(i,e.wa(s));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),s++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=B(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Pa(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Rr.fromDate(t);return{timestampValue:Bc(e.serializer,n)}}if(t instanceof Rr){const n=new Rr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Bc(e.serializer,n)}}if(t instanceof jh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vh)return{bytesValue:Uc(e.serializer,t._byteString)};if(t instanceof Nh){const n=e.databaseId,s=t.firestore._databaseId;if(!s.isEqual(n))throw e._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:$c(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e._a(`Unsupported field value: ${_h(t)}`)}(t,e)}function Xh(t,e){const n={};return to(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zr(t,((t,s)=>{const i=Wh(s,e.ha(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Yh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Rr||t instanceof jh||t instanceof Vh||t instanceof Nh||t instanceof Uh)}function Jh(t,e,n){if(!Yh(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const s=_h(n);throw"an object"===s?e._a(t+" a custom object"):e._a(t+" "+s)}}function Zh(t,e,n){if((e=B(e))instanceof Bh)return e._internalPath;if("string"==typeof e)return ed(t,e);throw nd("Field path arguments must be of type string or ",t,!1,void 0,n)}const td=new RegExp("[~\\*/\\[\\]]");function ed(t,e,n){if(e.search(td)>=0)throw nd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Bh(...e.split("."))._internalPath}catch(s){throw nd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function nd(t,e,n,s,i){const r=s&&!s.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${s}`),o&&(c+=` in document ${i}`),c+=")"),new br(wr.INVALID_ARGUMENT,a+t+c)}function sd(t,e){return t.some((t=>t.isEqual(e)))}class id{constructor(t,e,n,s,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Nh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new rd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(od("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class rd extends id{data(){return super.data()}}function od(t,e){return"string"==typeof e?ed(t,e):e instanceof Bh?e._internalPath:e._delegate._internalPath}class ad{convertValue(t,e="none"){switch(bo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ho(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(fo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw mr()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Zr(t,((t,s)=>{n[t]=this.convertValue(s,e)})),n}convertGeoPoint(t){return new jh(ho(t.latitude),ho(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=go(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(mo(t));default:return null}}convertTimestamp(t){const e=lo(t);return new Rr(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Fr.fromString(t);yr(cu(n));const s=new vo(n.get(1),n.get(3)),i=new Ur(n.popFirst(5));return s.isEqual(e)||fr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}class cd{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class ud extends id{constructor(t,e,n,s,i,r){super(t,e,n,s,r),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new ld(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(od("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class ld extends ud{data(t={}){return super.data(t)}}class hd{constructor(t,e,n,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new cd(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new ld(this._firestore,this._userDataWriter,n.key,n,new cd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new br(wr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const s=new ld(t._firestore,t._userDataWriter,n.doc.key,n.doc,new cd(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:s,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const s=new ld(t._firestore,t._userDataWriter,e.doc.key,e.doc,new cd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,r=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),r=n.indexOf(e.doc.key)),{type:dd(e.type),doc:s,oldIndex:i,newIndex:r}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function dd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mr()}}class fd extends ad{constructor(t){super(),this.firestore=t}convertBytes(t){return new Vh(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Nh(this.firestore,null,e)}}function pd(t,e){const n=Ah(t.firestore,Mh),s=function(t,e,...n){if(t=B(t),1===arguments.length&&(e=Lr.A()),Ih("doc","path",e),t instanceof kh){const s=Fr.fromString(e,...n);return Sh(s),new Nh(t,null,new Ur(s))}{if(!(t instanceof Nh||t instanceof xh))throw new br(wr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Fr.fromString(e,...n));return Sh(s),new Nh(t.firestore,t instanceof xh?t.converter:null,new Ur(s))}}(t),i=function(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}(t.converter,e);return function(t,e){return function(t,e){const n=new Er;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const s=hh(t);try{const t=await function(t,e){const n=vr(t),s=Rr.now(),i=e.reduce(((t,e)=>t.add(e.key)),xa());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Ia(),c=xa();return n.Zi.getEntries(t,i).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((i=>{r=i;const o=[];for(const t of e){const e=nc(t,r.get(t.key).overlayedDocument);null!=e&&o.push(new rc(t.key,e,Mo(e.value.mapValue),Xa.exists(!0)))}return n.mutationQueue.addMutationBatch(t,s,o,e)})).next((e=>{o=e;const s=e.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,s)}))})).then((()=>({batchId:o.batchId,changes:_a(r)})))}(s.localStore,e);s.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let s=t.Tc[t.currentUser.toKey()];s||(s=new eo(xr)),s=s.insert(e,n),t.Tc[t.currentUser.toKey()]=s}(s,t.batchId,n),await ch(s,t.changes),await wl(s.remoteStore)}catch(t){const e=xl(t,"Failed to persist write");n.reject(e)}}(await function(t){return vh(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Ph(t),e)}(n,[Qh(Gh(t.firestore),"addDoc",s._key,i,null!==t.converter,{}).toMutation(s._key,Xa.exists(!1))]).then((()=>s))}!function(t,e=!0){ur="9.23.0",St(new U("firestore",((t,{instanceIdentifier:n,options:s})=>{const i=t.getProvider("app").getImmediate(),r=new Mh(new Cr(t.getProvider("auth-internal")),new kr(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new br(wr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vo(t.options.projectId,e)}(i,n),i);return s=Object.assign({useFetchStreams:e},s),r._setSettings(s),r}),"PUBLIC").setMultipleInstances(!0)),Nt(ar,"3.13.0",t),Nt(ar,"3.13.0","esm2017")}(),Nt("firebase","9.23.0","app");const gd=(t,e)=>e.some((e=>t instanceof e));let md,yd;const vd=new WeakMap,wd=new WeakMap,bd=new WeakMap,Ed=new WeakMap,Td=new WeakMap;let Id={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return wd.get(t);if("objectStoreNames"===e)return t.objectStoreNames||bd.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Cd(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Sd(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yd||(yd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(_d(this),t),Cd(vd.get(this))}:function(...t){return Cd(e.apply(_d(this),t))}:function(t,...n){const s=e.call(_d(this),t,...n);return bd.set(s,t.sort?t.sort():[t]),Cd(s)}:(t instanceof IDBTransaction&&function(t){if(wd.has(t))return;const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",r),t.removeEventListener("abort",r)},i=()=>{e(),s()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",r),t.addEventListener("abort",r)}));wd.set(t,e)}(t),gd(t,md||(md=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Id):t);var e}function Cd(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",r)},i=()=>{e(Cd(t.result)),s()},r=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&vd.set(e,t)})).catch((()=>{})),Td.set(e,t),e}(t);if(Ed.has(t))return Ed.get(t);const e=Sd(t);return e!==t&&(Ed.set(t,e),Td.set(e,t)),e}const _d=t=>Td.get(t),Ad=["get","getKey","getAll","getAllKeys","count"],Dd=["put","add","delete","clear"],kd=new Map;function Nd(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(kd.get(e))return kd.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=Dd.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!i&&!Ad.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,i?"readwrite":"readonly");let o=r.store;return s&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&r.done]))[0]};return kd.set(e,r),r}Id=(t=>({...t,get:(e,n,s)=>Nd(e,n)||t.get(e,n,s),has:(e,n)=>!!Nd(e,n)||t.has(e,n)}))(Id);const Ld="@firebase/installations",xd="0.6.4",Od=1e4,Rd=`w:${xd}`,Md="FIS_v2",Pd="https://firebaseinstallations.googleapis.com/v1",Fd=36e5,Vd=new N("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Bd(t){return t instanceof k&&t.code.includes("request-failed")}function Ud({projectId:t}){return`${Pd}/projects/${t}/installations`}function jd(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function qd(t,e){const n=(await e.json()).error;return Vd.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function $d({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function zd(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Kd(t){return new Promise((e=>{setTimeout(e,t)}))}const Hd=/^[cdef][\w-]{21}$/,Gd="";function Qd(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return Hd.test(e)?e:Gd}catch(t){return Gd}}function Wd(t){return`${t.appName}!${t.appId}`}const Xd=new Map;function Yd(t,e){const n=Wd(t);Jd(n,e),function(t,e){const n=(!Zd&&"BroadcastChannel"in self&&(Zd=new BroadcastChannel("[Firebase] FID Change"),Zd.onmessage=t=>{Jd(t.data.key,t.data.fid)}),Zd);n&&n.postMessage({key:t,fid:e}),0===Xd.size&&Zd&&(Zd.close(),Zd=null)}(n,e)}function Jd(t,e){const n=Xd.get(t);if(n)for(const t of n)t(e)}let Zd=null;const tf="firebase-installations-database",ef=1,nf="firebase-installations-store";let sf=null;function rf(){return sf||(sf=function(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),a=Cd(o);return s&&o.addEventListener("upgradeneeded",(t=>{s(Cd(o.result),t.oldVersion,t.newVersion,Cd(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),i&&t.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}(tf,ef,{upgrade:(t,e)=>{0===e&&t.createObjectStore(nf)}})),sf}async function of(t,e){const n=Wd(t),s=(await rf()).transaction(nf,"readwrite"),i=s.objectStore(nf),r=await i.get(n);return await i.put(e,n),await s.done,r&&r.fid===e.fid||Yd(t,e.fid),e}async function af(t){const e=Wd(t),n=(await rf()).transaction(nf,"readwrite");await n.objectStore(nf).delete(e),await n.done}async function cf(t,e){const n=Wd(t),s=(await rf()).transaction(nf,"readwrite"),i=s.objectStore(nf),r=await i.get(n),o=e(r);return void 0===o?await i.delete(n):await i.put(o,n),await s.done,!o||r&&r.fid===o.fid||Yd(t,o.fid),o}async function uf(t){let e;const n=await cf(t.appConfig,(n=>{const s=function(t){return df(t||{fid:Qd(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Vd.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=Ud(t),i=$d(t),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&i.append("x-firebase-client",t)}const o={fid:n,authVersion:Md,appId:t.appId,sdkVersion:Rd},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await zd((()=>fetch(s,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:jd(t.authToken)}}throw await qd("Create Installation",c)}(t,e);return of(t.appConfig,n)}catch(n){throw Bd(n)&&409===n.customData.serverCode?await af(t.appConfig):await of(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:s}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:lf(t)}:{installationEntry:e}}(t,s);return e=i.registrationPromise,i.installationEntry}));return n.fid===Gd?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function lf(t){let e=await hf(t.appConfig);for(;1===e.registrationStatus;)await Kd(100),e=await hf(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await uf(t);return n||e}return e}function hf(t){return cf(t,(t=>{if(!t)throw Vd.create("installation-not-found");return df(t)}))}function df(t){return 1===(e=t).registrationStatus&&e.registrationTime+Od<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function ff({appConfig:t,heartbeatServiceProvider:e},n){const s=function(t,{fid:e}){return`${Ud(t)}/${e}/authTokens:generate`}(t,n),i=function(t,{refreshToken:e}){const n=$d(t);return n.append("Authorization",function(t){return`${Md} ${t}`}(e)),n}(t,n),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&i.append("x-firebase-client",t)}const o={installation:{sdkVersion:Rd,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await zd((()=>fetch(s,a)));if(c.ok)return jd(await c.json());throw await qd("Generate Auth Token",c)}async function pf(t,e=!1){let n;const s=await cf(t.appConfig,(s=>{if(!mf(s))throw Vd.create("not-registered");const i=s.authToken;if(!e&&(2===(r=i).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Fd}(r)))return s;var r;if(1===i.requestStatus)return n=async function(t,e){let n=await gf(t.appConfig);for(;1===n.authToken.requestStatus;)await Kd(100),n=await gf(t.appConfig);const s=n.authToken;return 0===s.requestStatus?pf(t,e):s}(t,e),s;{if(!navigator.onLine)throw Vd.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(s);return n=async function(t,e){try{const n=await ff(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await of(t.appConfig,s),n}catch(n){if(!Bd(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await of(t.appConfig,n)}else await af(t.appConfig);throw n}}(t,e),e}}));return n?await n:s.authToken}function gf(t){return cf(t,(t=>{if(!mf(t))throw Vd.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+Od<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function mf(t){return void 0!==t&&2===t.registrationStatus}function yf(t){return Vd.create("missing-app-config-values",{valueName:t})}const vf="installations";St(new U(vf,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw yf("App Configuration");if(!t.name)throw yf("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw yf(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:Ct(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),St(new U("installations-internal",(t=>{const e=Ct(t.getProvider("app").getImmediate(),vf).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:s}=await uf(e);return s?s.catch(console.error):pf(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await uf(t);e&&await e}(n),(await pf(n,e)).token}(e,t)}}),"PRIVATE")),Nt(Ld,xd),Nt(Ld,xd,"esm2017");const wf="analytics",bf="firebase_id",Ef="origin",Tf=6e4,If="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Sf="https://www.googletagmanager.com/gtag/js",Cf=new Y("@firebase/analytics"),_f=new N("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Af(t){if(!t.startsWith(Sf)){const e=_f.create("invalid-gtag-resource",{gtagURL:t});return Cf.warn(e.message),""}return t}function Df(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const kf=30,Nf=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Lf(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function xf(t,e=Nf,n){const{appId:s,apiKey:i,measurementId:r}=t.options;if(!s)throw _f.create("no-app-id");if(!i){if(r)return{measurementId:r,appId:s};throw _f.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Rf;return setTimeout((async()=>{a.abort()}),void 0!==n?n:Tf),Of({appId:s,apiKey:i,measurementId:r},o,a,e)}async function Of(t,{throttleEndTimeMillis:e,backoffCount:n},s,i=Nf){var r;const{appId:o,measurementId:a}=t;try{await function(t,e){return new Promise(((n,s)=>{const i=Math.max(e-Date.now(),0),r=setTimeout(n,i);t.addEventListener((()=>{clearTimeout(r),s(_f.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(s,e)}catch(t){if(a)return Cf.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:o,measurementId:a};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:s}=t,i={method:"GET",headers:Lf(s)},r=If.replace("{app-id}",n),o=await fetch(r,i);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw _f.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return i.deleteThrottleMetadata(o),e}catch(e){const c=e;if(!function(t){if(!(t instanceof k&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c)){if(i.deleteThrottleMetadata(o),a)return Cf.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw e}const u=503===Number(null===(r=null==c?void 0:c.customData)||void 0===r?void 0:r.httpStatus)?V(n,i.intervalMillis,kf):V(n,i.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return i.setThrottleMetadata(o,l),Cf.debug(`Calling attemptFetch again in ${u} millis`),Of(t,l,s,i)}}class Rf{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let Mf,Pf;async function Ff(t,e,n,s,i,r,o){var a;const c=xf(t);c.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Cf.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>Cf.error(t))),e.push(c);const u=async function(){if(!A())return Cf.warn(_f.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await D()}catch(t){return Cf.warn(_f.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?s.getId():void 0)),[l,h]=await Promise.all([c,u]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Sf)&&n.src.includes(t))return n;return null})(r)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:Af}),s=document.createElement("script"),i=`${Sf}?l=${t}&id=${e}`;s.src=n?null==n?void 0:n.createScriptURL(i):i,s.async=!0,document.head.appendChild(s)}(r,l.measurementId),Pf&&(i("consent","default",Pf),Pf=void 0),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[Ef]="firebase",d.update=!0,null!=h&&(d[bf]=h),i("config",l.measurementId,d),Mf&&(i("set",Mf),Mf=void 0),l.measurementId}class Vf{constructor(t){this.app=t}_delete(){return delete Bf[this.app.options.appId],Promise.resolve()}}let Bf={},Uf=[];const jf={};let qf,$f,zf="dataLayer",Kf=!1;function Hf(t,e,n){!function(){const t=[];if(function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=_f.create("invalid-analytics-context",{errorInfo:e});Cf.warn(n.message)}}();const s=t.options.appId;if(!s)throw _f.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw _f.create("no-api-key");Cf.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Bf[s])throw _f.create("already-exists",{id:s});if(!Kf){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(zf);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,s,i){let r=function(...t){window[s].push(arguments)};return window[i]&&"function"==typeof window[i]&&(r=window[i]),window[i]=function(t,e,n,s){return async function(i,...r){try{if("event"===i){const[s,i]=r;await async function(t,e,n,s,i){try{let r=[];if(i&&i.send_to){let t=i.send_to;Array.isArray(t)||(t=[t]);const s=await Df(n);for(const n of t){const t=s.find((t=>t.measurementId===n)),i=t&&e[t.appId];if(!i){r=[];break}r.push(i)}}0===r.length&&(r=Object.values(e)),await Promise.all(r),t("event",s,i||{})}catch(t){Cf.error(t)}}(t,e,n,s,i)}else if("config"===i){const[i,o]=r;await async function(t,e,n,s,i,r){const o=s[i];try{if(o)await e[o];else{const t=(await Df(n)).find((t=>t.measurementId===i));t&&await e[t.appId]}}catch(t){Cf.error(t)}t("config",i,r)}(t,e,n,s,i,o)}else if("consent"===i){const[e]=r;t("consent","update",e)}else if("get"===i){const[e,n,s]=r;t("get",e,n,s)}else if("set"===i){const[e]=r;t("set",e)}else t(i,...r)}catch(t){Cf.error(t)}}}(r,t,e,n),{gtagCore:r,wrappedGtag:window[i]}}(Bf,Uf,jf,zf,"gtag");$f=t,qf=e,Kf=!0}return Bf[s]=Ff(t,Uf,jf,e,qf,zf,n),new Vf(t)}const Gf="@firebase/analytics",Qf="0.10.0";St(new U(wf,((t,{options:e})=>Hf(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),St(new U("analytics-internal",(function(t){try{const e=t.getProvider(wf).getImmediate();return{logEvent:(t,n,s)=>function(t,e,n,s){t=B(t),async function(t,e,n,s,i){if(i&&i.global)t("event",n,s);else{const i=await e;t("event",n,Object.assign(Object.assign({},s),{send_to:i}))}}($f,Bf[t.app.options.appId],e,n,s).catch((t=>Cf.error(t)))}(e,t,n,s)}}catch(t){throw _f.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Nt(Gf,Qf),Nt(Gf,Qf,"esm2017");const Wf=Dt({apiKey:"AIzaSyBgbLkc7a5XLLdygP9GXnXaM5Vrovp2dC8",authDomain:"star-hunter-game.firebaseapp.com",projectId:"star-hunter-game",storageBucket:"star-hunter-game.appspot.com",messagingSenderId:"489638872930",appId:"1:489638872930:web:b76a029d8fd9fb1233ce3b",measurementId:"G-93VGPT7HB0"}),Xf=function(t,e){const n="string"==typeof t?t:"(default)",s=Ct("object"==typeof t?t:kt(),"firestore").getImmediate({identifier:n});if(!s._initialized){const t=(t=>{const e=(t=>{var e,n;return null===(n=null===(e=S())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),s]:[e.substring(0,n),s]})("firestore");t&&function(t,e,n,s={}){var i;const r=(t=Ah(t,kh))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==r.host&&r.host!==o&&pr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),s.mockUserToken){let e,n;if("string"==typeof s.mockUserToken)e=s.mockUserToken,n=cr.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[I(JSON.stringify({alg:"none",type:"JWT"})),I(JSON.stringify(r)),""].join(".")}(s.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const r=s.mockUserToken.sub||s.mockUserToken.user_id;if(!r)throw new br(wr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new cr(r)}t._authCredentials=new Sr(new Tr(e,n))}}(s,...t)}return s}(Wf),Yf=(function(t=kt()){const e=Ct(t=B(t),wf);e.isInitialized()?e.getImmediate():function(t,e={}){const n=Ct(t,wf);if(n.isInitialized()){const t=n.getImmediate();if(x(e,n.getOptions()))return t;throw _f.create("already-initialized")}n.initialize({options:e})}(t)}(Wf),n.p+"asset-packs/preload-asset-pack-a0c8695f98f8afae49e5.json");class Jf{rootNode;userScores;scoreListTemplate=document.createElement("ul");scoreItemTemplate='\n    <li class="high-scores__item">\n    </li>\n  ';constructor(t,e){this.rootNode=t,this.userScores=e,this._initNodes(),this._initEvents(),this._renderTable()}_initNodes(){this.scoreListTemplate=document.createElement("ul"),this.scoreListTemplate.classList.add("high-scores__list")}_initEvents(){}_sortItems(){this.userScores.sort(((t,e)=>t.value>e.value?-1:1))}_renderTable(){const t=10<=this.userScores.length?10:this.userScores.length;this._sortItems();for(let e=0;e<t;e++){const t=document.createElement("li");t.classList.add("high-scores__item"),t.innerHTML=`\n        <span class="high-scores__name">${this.userScores[e].name}</span>\n        <span>..........................</span>\n        <span class="high-scores__value">${this.userScores[e].value}</span>\n      `,this.scoreListTemplate.appendChild(t)}this.rootNode.classList.remove("is-loading"),this.rootNode.appendChild(this.scoreListTemplate)}}const Zf=l,tp=l+"__button",ep=l+"__close";(async()=>{const t=[];(await function(t){t=Ah(t,Lh);const e=Ah(t.firestore,Mh),n=Ph(e),s=new fd(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new br(wr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),bh(n,t._query).then((n=>new hd(e,s,t,n)))}(Oh(Xf,"scores"))).forEach((e=>{t.push({name:e.data().name,value:e.data().value})})),new Jf(document.querySelector(".js-high-scores"),t)})(),p.setState({currentScore:0}),new class{state={currentScore:0};scoreNodes=[];constructor(){this._initEvents()}_initEvents(){window.addEventListener("app:refresh",(()=>{this.state.currentScore=p.state.currentScore,this._initNodes(),this._updateMarkup()}))}_initNodes(){this.scoreNodes=[...document.querySelectorAll(".js-score-node")]}_updateMarkup(){this.scoreNodes.forEach((t=>{t.innerHTML=this.state.currentScore.toString()}))}};let np=null;new class{state={userName:"",userScore:0};userNameInputNode=null;saveButtonNode=null;closeButtonNode=null;rootNode=null;constructor(){this._initState(),this._initNodes(),this._initEvents()}_initNodes(){if(this.rootNode=document.querySelector("."+Zf),this.userNameInputNode=document.getElementById("userName"),this.saveButtonNode=document.querySelector("."+tp),this.closeButtonNode=document.querySelector("."+ep),!this.userNameInputNode)return!1;this.state.userName.length&&(this.userNameInputNode.value=this.state.userName)}_initEvents(){this.userNameInputNode.addEventListener("input",(t=>{const e=t.target;this.state.userName=e.value,localStorage.setItem(d,e.value)})),this.saveButtonNode.addEventListener("click",(()=>{this._saveScore(),this.saveButtonNode.classList.add("is-disabled")})),this.closeButtonNode.addEventListener("click",(()=>{this._resetGame()})),window.addEventListener("game:over",(()=>{this._showNicknameInput()})),window.addEventListener("app:refresh",(()=>{this.state.userScore=p.state.currentScore}))}_initState(){const t=localStorage.getItem(d);this.state.userScore=p.state.currentScore,t&&(this.state.userName=t)}_showNicknameInput(){this.rootNode.classList.add("is-visible")}async _saveScore(){if(this.state.userName.length>0)try{await pd(Oh(Xf,"scores"),{name:this.state.userName,value:this.state.userScore}),this._resetGame()}catch(t){console.error("Error adding document: ",t)}else this._resetGame()}_resetGame(){window.location.reload()}},(new class{parentNodesArray=[];_initNodes(){this.parentNodesArray=Array.from(document.querySelectorAll(".js-toggle-class"))}_initEvents(){this.parentNodesArray.forEach((t=>{const e=void 0!==t.dataset.toggleOnMouseenter?"mouseenter":"click",n=void 0!==t.dataset.toggleOuterClickRemove,s=()=>{void 0!==t.dataset.toggleOnce&&t.removeEventListener(e,s),this._toggleCssClass(t)};n&&(p.customEventsListeners.push(t),t.addEventListener(f.closeDropdown,(()=>{this._toggleCssClass(t,!0)}))),t.addEventListener(e,s)}))}_toggleCssClass(t,e){const n=t.dataset.toggleClass,s=void 0!==t.dataset.bodyBlock,i=document.getElementById(t.dataset.toggleTargetId),r=t.closest("."+t.dataset.toggleClosestTarget);let o=null;n?(i&&(e?i.classList.remove(n):i.classList.toggle(n)),r&&(e?r.classList.remove(n):r.classList.toggle(n)),i||r||(e?t.classList.remove(n):t.classList.toggle(n)),o=i&&i.classList.contains(n)||r&&r.classList.contains(n)||t.classList.contains(n),s&&(o?document.body.classList.add(h):document.body.classList.remove(h))):console.warn("ToggleCssClass: No css class to toggle")}init(){this._initNodes(),this._initEvents()}}).init();class sp extends i().Scene{constructor(){super("Boot")}preload(){this.load.pack("pack",Yf)}create(){this.scene.start("Preload")}}window.addEventListener("load",(function(){document.getElementById("startButton")?.addEventListener("click",(function(){document.body.classList.add("is-game-started"),np=new(i().Game)({width:1280,height:1280/1.78,parent:"gameContent",backgroundColor:"#2f2f2f",scale:{mode:i().Scale.ScaleModes.FIT,autoCenter:i().Scale.Center.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{y:300}}},scene:[sp,w,g]}),np.scene.start("Boot")})),document.getElementById("resetButton")?.addEventListener("click",(function(){window.location.reload()}))}))}},i={};function r(t){var e=i[t];if(void 0!==e){if(void 0!==e.error)throw e.error;return e.exports}var n=i[t]={id:t,exports:{}};try{var o={id:t,module:n,factory:s[t],require:r};r.i.forEach((function(t){t(o)})),n=o.module,o.factory.call(n.exports,n,n.exports,o.require)}catch(t){throw n.error=t,t}return n.exports}r.m=s,r.c=i,r.i=[],t=[],r.O=(e,n,s,i)=>{if(!n){var o=1/0;for(l=0;l<t.length;l++){for(var[n,s,i]=t[l],a=!0,c=0;c<n.length;c++)(!1&i||o>=i)&&Object.keys(r.O).every((t=>r.O[t](n[c])))?n.splice(c--,1):(a=!1,i<o&&(o=i));if(a){t.splice(l--,1);var u=s();void 0!==u&&(e=u)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[n,s,i]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.hu=t=>t+"."+r.h()+".hot-update.js",r.miniCssF=t=>{},r.hmrF=()=>"main."+r.h()+".hot-update.json",r.h=()=>"d557a0ffc45935203e99",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),e={},n="phaser3-webpack-template:",r.l=(t,s,i,o)=>{if(e[t])e[t].push(s);else{var a,c;if(void 0!==i)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==t||h.getAttribute("data-webpack")==n+i){a=h;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",n+i),a.src=t),e[t]=[s];var d=(n,s)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[t];if(delete e[t],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((t=>t(s))),n)return n(s)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}},(()=>{var t,e,n,s={},i=r.c,o=[],a=[],c="idle",u=0,l=[];function h(t){c=t;for(var e=[],n=0;n<a.length;n++)e[n]=a[n].call(null,t);return Promise.all(e)}function d(){0==--u&&h("ready").then((function(){if(0===u){var t=l;l=[];for(var e=0;e<t.length;e++)t[e]()}}))}function f(t){if("idle"!==c)throw new Error("check() is only allowed in idle status");return h("check").then(r.hmrM).then((function(n){return n?h("prepare").then((function(){var s=[];return e=[],Promise.all(Object.keys(r.hmrC).reduce((function(t,i){return r.hmrC[i](n.c,n.r,n.m,t,e,s),t}),[])).then((function(){return e=function(){return t?g(t):h("ready").then((function(){return s}))},0===u?e():new Promise((function(t){l.push((function(){t(e())}))}));var e}))})):h(m()?"ready":"idle").then((function(){return null}))}))}function p(t){return"ready"!==c?Promise.resolve().then((function(){throw new Error("apply() is only allowed in ready status (state: "+c+")")})):g(t)}function g(t){t=t||{},m();var s=e.map((function(e){return e(t)}));e=void 0;var i=s.map((function(t){return t.error})).filter(Boolean);if(i.length>0)return h("abort").then((function(){throw i[0]}));var r=h("dispose");s.forEach((function(t){t.dispose&&t.dispose()}));var o,a=h("apply"),c=function(t){o||(o=t)},u=[];return s.forEach((function(t){if(t.apply){var e=t.apply(c);if(e)for(var n=0;n<e.length;n++)u.push(e[n])}})),Promise.all([r,a]).then((function(){return o?h("fail").then((function(){throw o})):n?g(t).then((function(t){return u.forEach((function(e){t.indexOf(e)<0&&t.push(e)})),t})):h("idle").then((function(){return u}))}))}function m(){if(n)return e||(e=[]),Object.keys(r.hmrI).forEach((function(t){n.forEach((function(n){r.hmrI[t](n,e)}))})),n=void 0,!0}r.hmrD=s,r.i.push((function(l){var g,m,y,v,w=l.module,b=function(e,n){var s=i[n];if(!s)return e;var r=function(r){if(s.hot.active){if(i[r]){var a=i[r].parents;-1===a.indexOf(n)&&a.push(n)}else o=[n],t=r;-1===s.children.indexOf(r)&&s.children.push(r)}else console.warn("[HMR] unexpected require("+r+") from disposed module "+n),o=[];return e(r)},a=function(t){return{configurable:!0,enumerable:!0,get:function(){return e[t]},set:function(n){e[t]=n}}};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&"e"!==l&&Object.defineProperty(r,l,a(l));return r.e=function(t){return function(t){switch(c){case"ready":h("prepare");case"prepare":return u++,t.then(d,d),t;default:return t}}(e.e(t))},r}(l.require,l.id);w.hot=(g=l.id,m=w,v={_acceptedDependencies:{},_acceptedErrorHandlers:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:y=t!==g,_requireSelf:function(){o=m.parents.slice(),t=y?void 0:g,r(g)},active:!0,accept:function(t,e,n){if(void 0===t)v._selfAccepted=!0;else if("function"==typeof t)v._selfAccepted=t;else if("object"==typeof t&&null!==t)for(var s=0;s<t.length;s++)v._acceptedDependencies[t[s]]=e||function(){},v._acceptedErrorHandlers[t[s]]=n;else v._acceptedDependencies[t]=e||function(){},v._acceptedErrorHandlers[t]=n},decline:function(t){if(void 0===t)v._selfDeclined=!0;else if("object"==typeof t&&null!==t)for(var e=0;e<t.length;e++)v._declinedDependencies[t[e]]=!0;else v._declinedDependencies[t]=!0},dispose:function(t){v._disposeHandlers.push(t)},addDisposeHandler:function(t){v._disposeHandlers.push(t)},removeDisposeHandler:function(t){var e=v._disposeHandlers.indexOf(t);e>=0&&v._disposeHandlers.splice(e,1)},invalidate:function(){switch(this._selfInvalidated=!0,c){case"idle":e=[],Object.keys(r.hmrI).forEach((function(t){r.hmrI[t](g,e)})),h("ready");break;case"ready":Object.keys(r.hmrI).forEach((function(t){r.hmrI[t](g,e)}));break;case"prepare":case"check":case"dispose":case"apply":(n=n||[]).push(g)}},check:f,apply:p,status:function(t){if(!t)return c;a.push(t)},addStatusHandler:function(t){a.push(t)},removeStatusHandler:function(t){var e=a.indexOf(t);e>=0&&a.splice(e,1)},data:s[g]},t=void 0,v),w.parents=o,w.children=[],o=[],l.require=b})),r.hmrC={},r.hmrI={}})(),(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{if("undefined"!=typeof document){var t=[],e=[],n=n=>({dispose:()=>{for(var e=0;e<t.length;e++){var n=t[e];n.parentNode&&n.parentNode.removeChild(n)}t.length=0},apply:()=>{for(var t=0;t<e.length;t++)e[t].rel="stylesheet";e.length=0}});r.hmrC.miniCss=(s,i,o,a,c,u)=>{c.push(n),s.forEach((n=>{var s=r.miniCssF(n),i=r.p+s,o=((t,e)=>{for(var n=document.getElementsByTagName("link"),s=0;s<n.length;s++){var i=(o=n[s]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(i===t||i===e))return o}var r=document.getElementsByTagName("style");for(s=0;s<r.length;s++){var o;if((i=(o=r[s]).getAttribute("data-href"))===t||i===e)return o}})(s,i);o&&a.push(new Promise(((s,r)=>{var a=((t,e,n,s,i)=>{var r=document.createElement("link");return r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=n=>{if(r.onerror=r.onload=null,"load"===n.type)s();else{var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.href||e,c=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=o,c.request=a,r.parentNode&&r.parentNode.removeChild(r),i(c)}},r.href=e,n?n.parentNode.insertBefore(r,n.nextSibling):document.head.appendChild(r),r})(n,i,o,(()=>{a.as="style",a.rel="preload",s()}),r);t.push(o),e.push(a)})))}))}}})(),(()=>{var t,e,n,s,i,o=r.hmrS_jsonp=r.hmrS_jsonp||{179:0},a={};function c(e,n){return t=n,new Promise(((t,n)=>{a[e]=t;var s=r.p+r.hu(e),i=new Error;r.l(s,(t=>{if(a[e]){a[e]=void 0;var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;i.message="Loading hot update chunk "+e+" failed.\n("+s+": "+r+")",i.name="ChunkLoadError",i.type=s,i.request=r,n(i)}}))}))}function u(t){function a(t){for(var e=[t],n={},s=e.map((function(t){return{chain:[t],id:t}}));s.length>0;){var i=s.pop(),o=i.id,a=i.chain,u=r.c[o];if(u&&(!u.hot._selfAccepted||u.hot._selfInvalidated)){if(u.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:o};if(u.hot._main)return{type:"unaccepted",chain:a,moduleId:o};for(var l=0;l<u.parents.length;l++){var h=u.parents[l],d=r.c[h];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:a.concat([h]),moduleId:o,parentId:h};-1===e.indexOf(h)&&(d.hot._acceptedDependencies[o]?(n[h]||(n[h]=[]),c(n[h],[o])):(delete n[h],e.push(h),s.push({chain:a.concat([h]),id:h})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:n}}function c(t,e){for(var n=0;n<e.length;n++){var s=e[n];-1===t.indexOf(s)&&t.push(s)}}r.f&&delete r.f.jsonpHmr,e=void 0;var u={},l=[],h={},d=function(t){console.warn("[HMR] unexpected require("+t.id+") to disposed module")};for(var f in n)if(r.o(n,f)){var p,g=n[f],m=!1,y=!1,v=!1,w="";switch((p=g?a(f):{type:"disposed",moduleId:f}).chain&&(w="\nUpdate propagation: "+p.chain.join(" -> ")),p.type){case"self-declined":t.onDeclined&&t.onDeclined(p),t.ignoreDeclined||(m=new Error("Aborted because of self decline: "+p.moduleId+w));break;case"declined":t.onDeclined&&t.onDeclined(p),t.ignoreDeclined||(m=new Error("Aborted because of declined dependency: "+p.moduleId+" in "+p.parentId+w));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(p),t.ignoreUnaccepted||(m=new Error("Aborted because "+f+" is not accepted"+w));break;case"accepted":t.onAccepted&&t.onAccepted(p),y=!0;break;case"disposed":t.onDisposed&&t.onDisposed(p),v=!0;break;default:throw new Error("Unexception type "+p.type)}if(m)return{error:m};if(y)for(f in h[f]=g,c(l,p.outdatedModules),p.outdatedDependencies)r.o(p.outdatedDependencies,f)&&(u[f]||(u[f]=[]),c(u[f],p.outdatedDependencies[f]));v&&(c(l,[p.moduleId]),h[f]=d)}n=void 0;for(var b,E=[],T=0;T<l.length;T++){var I=l[T],S=r.c[I];S&&(S.hot._selfAccepted||S.hot._main)&&h[I]!==d&&!S.hot._selfInvalidated&&E.push({module:I,require:S.hot._requireSelf,errorHandler:S.hot._selfAccepted})}return{dispose:function(){var t;s.forEach((function(t){delete o[t]})),s=void 0;for(var e,n=l.slice();n.length>0;){var i=n.pop(),a=r.c[i];if(a){var c={},h=a.hot._disposeHandlers;for(T=0;T<h.length;T++)h[T].call(null,c);for(r.hmrD[i]=c,a.hot.active=!1,delete r.c[i],delete u[i],T=0;T<a.children.length;T++){var d=r.c[a.children[T]];d&&(t=d.parents.indexOf(i))>=0&&d.parents.splice(t,1)}}}for(var f in u)if(r.o(u,f)&&(a=r.c[f]))for(b=u[f],T=0;T<b.length;T++)e=b[T],(t=a.children.indexOf(e))>=0&&a.children.splice(t,1)},apply:function(e){for(var n in h)r.o(h,n)&&(r.m[n]=h[n]);for(var s=0;s<i.length;s++)i[s](r);for(var o in u)if(r.o(u,o)){var a=r.c[o];if(a){b=u[o];for(var c=[],d=[],f=[],p=0;p<b.length;p++){var g=b[p],m=a.hot._acceptedDependencies[g],y=a.hot._acceptedErrorHandlers[g];if(m){if(-1!==c.indexOf(m))continue;c.push(m),d.push(y),f.push(g)}}for(var v=0;v<c.length;v++)try{c[v].call(null,b)}catch(n){if("function"==typeof d[v])try{d[v](n,{moduleId:o,dependencyId:f[v]})}catch(s){t.onErrored&&t.onErrored({type:"accept-error-handler-errored",moduleId:o,dependencyId:f[v],error:s,originalError:n}),t.ignoreErrored||(e(s),e(n))}else t.onErrored&&t.onErrored({type:"accept-errored",moduleId:o,dependencyId:f[v],error:n}),t.ignoreErrored||e(n)}}}for(var w=0;w<E.length;w++){var T=E[w],I=T.module;try{T.require(I)}catch(n){if("function"==typeof T.errorHandler)try{T.errorHandler(n,{moduleId:I,module:r.c[I]})}catch(s){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:I,error:s,originalError:n}),t.ignoreErrored||(e(s),e(n))}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:I,error:n}),t.ignoreErrored||e(n)}}return l}}}self.webpackHotUpdatephaser3_webpack_template=(e,s,o)=>{for(var c in s)r.o(s,c)&&(n[c]=s[c],t&&t.push(c));o&&i.push(o),a[e]&&(a[e](),a[e]=void 0)},r.hmrI.jsonp=function(t,e){n||(n={},i=[],s=[],e.push(u)),r.o(n,t)||(n[t]=r.m[t])},r.hmrC.jsonp=function(t,a,l,h,d,f){d.push(u),e={},s=a,n=l.reduce((function(t,e){return t[e]=!1,t}),{}),i=[],t.forEach((function(t){r.o(o,t)&&void 0!==o[t]?(h.push(c(t,f)),e[t]=!0):e[t]=!1})),r.f&&(r.f.jsonpHmr=function(t,n){e&&r.o(e,t)&&!e[t]&&(n.push(c(t)),e[t]=!0)})},r.hmrM=()=>{if("undefined"==typeof fetch)throw new Error("No browser support: need fetch API");return fetch(r.p+r.hmrF()).then((t=>{if(404!==t.status){if(!t.ok)throw new Error("Failed to fetch update manifest "+t.statusText);return t.json()}}))},r.O.j=t=>0===o[t];var l=(t,e)=>{var n,s,[i,a,c]=e,u=0;if(i.some((t=>0!==o[t]))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(c)var l=c(r)}for(t&&t(e);u<i.length;u++)s=i[u],r.o(o,s)&&o[s]&&o[s][0](),o[s]=0;return r.O(l)},h=self.webpackChunkphaser3_webpack_template=self.webpackChunkphaser3_webpack_template||[];h.forEach(l.bind(null,0)),h.push=l.bind(null,h.push.bind(h))})();var o=r.O(void 0,[426],(()=>r(2)));o=r.O(o)})();